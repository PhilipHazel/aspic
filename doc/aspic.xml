<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN" "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">


<?sdop
  foot_right_recto="&chaptertitle; (&chapternumber;)"
  foot_right_verso="&chaptertitle; (&chapternumber;)"
  table_warn_overflow="overprint"
?>
<book>
<bookinfo>
<title>Aspic: A Line-Art Processor</title>
<titleabbrev>Aspic</titleabbrev>
<date>09 October 2022</date>
<author><firstname>Philip</firstname><surname>Hazel</surname></author>
<authorinitials>PH</authorinitials>
<revhistory><revision>
  <revnumber>2.00</revnumber>
  <date>09 October 2022</date>
  <authorinitials>PH</authorinitials>
</revision></revhistory>
<copyright><year>2022</year><holder>University of Cambridge</holder></copyright>
</bookinfo>
<chapter>
<title>Introduction to Aspic</title>
<para>
Aspic is a program that converts a textual description of a line drawing into
instructions that can be processed by standard software in order to draw the
picture. Usually this happens when the picture is included in some other
document. This method of defining line art graphics is the same as that of the
PIC system, described by Kernighan in <emphasis>Software &ndash; Practice and Experience</emphasis>,
<emphasis role="bold">12</emphasis>, pages 1&ndash;21 (1982), though the details of the Aspic commands are quite
different. Here is an example of the kind of picture Aspic can produce:
</para>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic00.eps"  scale="40" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Aspic is written in C. It was originally written in the early 1990s, but the
code has recently (2022) been tidied up and made more robust. It is developed
on Linux and is supplied with a conventional <emphasis>configure</emphasis> command, but as it
contains no system-specific code, it should be possible to run it in any
environment that has a standard C compiler and library.
</para>
<para>
Aspic reads Unicode input in UTF-8 format. The default output format is
Encapsulated PostScript (EPS), but there is also support for output in Scalable
Vector Graphics (SVG) format. Both these formats are widely supported by
browsers and text-processing software. Files generated by Aspic can be
displayed on their own by commands such as <emphasis>gv</emphasis> (eps), <emphasis>evince</emphasis> (eps),
<emphasis>feh</emphasis> (svg), <emphasis>qiv</emphasis> (svg) and the <emphasis>display</emphasis> command that is part of the
ImageMagick suite (both formats).
</para>
<para>
Aspic supports the inclusion of text in drawings, but it does no text
processing of its own. The implementation of operations such as text
justification and centering is left to the back-end rendering processor. Aspic
uses the font size to guess how much vertical space to leave between lines;
this can be increased by the user if necessary. Character encoding is discussed
in chapter <xref linkend="CHAPFONT"/>.
</para>
<section>
<title>The aspic command</title>
<para>
The command to run Aspic is as follows:
</para>
<literallayout>
<literal>aspic</literal>  [<emphasis>options</emphasis>]  [<emphasis>input</emphasis>  [<emphasis>output</emphasis>]]
</literallayout>
<para>
If no input or output is given, Aspic reads from the standard input and writes
to the standard output. If an input file name is given without an output, an
output file name is created by removing the input&#x2019;s extension (if any), and
adding <literal>.eps</literal> or <literal>.svg</literal> as appropriate. The standard input or output may be
explicitly referenced by specifying a single hyphen character. The options are
as follows:
</para>
<para>
<emphasis role="bold">-help</emphasis> causes Aspic to display usage information on the standard output, and
then exit.
</para>
<para>
<emphasis role="bold">-nv</emphasis> disables the use of Aspic variables. This means that dollar characters
in the input file are no longer treated specially. The option is useful when
there are dollar characters in an Aspic source that does not make use of Aspic
variables.
</para>
<para>
<emphasis role="bold">-eps</emphasis> or <emphasis role="bold">-ps</emphasis> (the default) causes Aspic to generate Encapsulated
PostScript.
</para>
<para>
<emphasis role="bold">-svg</emphasis> causes Aspic to generate Scalable Vector Graphics (SVG).
</para>
<para>
<emphasis role="bold">-tr</emphasis> causes Aspic to translate certain input characters; for example, a
grave accent is translated into a typographic opening quote. Details are given
in section <xref linkend="SECTCODES"/>.
</para>
<para>
<emphasis role="bold">-v</emphasis> or <emphasis role="bold">--version</emphasis> causes Aspic to display its version number on the
standard output, and then exit.
</para>
<para>
There is also a <emphasis role="bold">-testing</emphasis> option that is used in testing to suppress the
Aspic version number in the output, but is not intended for general use.
</para>
<para>
Error messages are written to the standard error stream. No output is generated
if any errors are found in the input. A few errors are sufficiently serious
that Aspic stops immediately, but for many it carries on and so may output more
than one error message. The return code is one of the C values EXIT_SUCCESS or
EXIT_FAILURE, which often equate to zero and one.
</para>
</section>
</chapter>

<chapter>
<title>Simple Aspic examples</title>
<para>
This chapter uses some simple examples to introduce the various facilities
that are available in Aspic. Subsequent chapters contain reference material
that explains things in more detail.
</para>
<para>
Aspic operates in a traditional Cartesian coordinate system, with the positive
directions to the right and upwards. For PostScript output the units of length
used in Aspic commands are printers&#x2019; points. There are 72 points to an inch.
SVG output contains the same dimensions without specifying a unit. The
interpretation is left to the rendering software. On a screen, SVG dimensions
are likely to be treated as numbers of pixels. The examples below all show
Aspic source, followed by the resulting picture. We start with a simple
diagram:
</para>
<literallayout class="monospaced">
box "A"; line; circle "B";
</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic01.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Each Aspic command is terminated by a semicolon, so there are three commands in
this example:
</para>
<orderedlist numeration="arabic">
<listitem>
<para>
The <emphasis role="bold">box</emphasis> command causes a box to be drawn, containing the text at its
centre. The default box size is 72 by 36 (that is, 1" &times; 0.5" for
PostScript output). There are commands to change the default &ndash; see chapter
<xref linkend="CHAPENV"/> &ndash; and the size of an individual box can of course be specified
(see below). There is also a <emphasis role="bold">magnify</emphasis> command that affects the sizes of all
shapes (but not the size of any text). In this document, all the examples are
reduced by a factor of 0.8, so the size of the box above is actually 0.8"
&times; 0.4".
</para>
</listitem>
<listitem>
<para>
The <emphasis role="bold">line</emphasis> command draws a straight line; as nothing else is specified, the
line is drawn in the current direction of motion, which defaults to the right.
The length is the standard horizontal line length, which defaults to 72.
</para>
</listitem>
<listitem>
<para>
The <emphasis role="bold">circle</emphasis> command draws a circle; as nothing was specified as to how it
should join onto its predecessor, the &#x2018;obvious&#x2019; joining position is chosen. The
circle is drawn at a standard size. (Again, there are commands for changing
this.) Aspic can draw ellipses as well as circles.
</para>
</listitem>
</orderedlist>
<para>
Each Aspic command that causes a shape to be drawn may have any number of text
strings associated with it. In the above example, the box and the circle each
have one associated string. For closed shapes such as these, the strings are
centred in the shape. For horizontal lines, the strings are centred above and
below the line, while for other kinds of line they are positioned near the
middle of the line. For example:
</para>
<literallayout class="monospaced">
line "first" "second"; line down "third" "fourth";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic02.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Strings may use different fonts, be of different sizes, and can be coloured.
There is also support for rotated strings. For details, see chapter
<xref linkend="CHAPOBJTEXT"/>. The commands introduced above may be used with options that
change the size of the shape that is drawn. For example:
</para>
<literallayout class="monospaced">
box width 100 depth 20; line right 40; circle radius 10;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic03.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The current direction of motion can be changed by the commands <emphasis role="bold">up</emphasis>, <emphasis role="bold">down</emphasis>,
<emphasis role="bold">left</emphasis>, and <emphasis role="bold">right</emphasis>. In addition, an individual line may be drawn in any
direction and of any length (without changing the defaults) by means of
appropriate options:
</para>
<literallayout class="monospaced">
down; box "A"; line; circle "B";
line right 40; line left 20 up 20; line;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic04.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The length values for lines are interpreted as distances in the Cartesian
coordinate directions rather than the actual length of the line drawn. There
are separate standard values for the horizontal and vertical lengths, which are
72 and 36, respectively, by default.
</para>
<literallayout class="monospaced">
line; line up right; line left; line down;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic05.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
If a sequence of closed shapes occurs, the shapes are joined together according
to the current direction of motion, but a closed shape following a line joins
according to the direction of the line.
</para>
<literallayout class="monospaced">
box "A"; box "B"; box "C"; line;
down; circle "D"; circle "E"; line left;
</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic06.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
There is a <emphasis role="bold">join</emphasis> option for specifying where a closed shape joins its
predecessor:
</para>
<literallayout class="monospaced">
box "A"; box join top left "B";
circle join centre; box join left "C";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic07.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The argument for <emphasis role="bold">join</emphasis> specifies a point on the new shape that is to be
joined to a point on the previous shape. Thus, in the above example, the top
left-hand corner of the second box is the point which is joined to the first
box. The joining point on the previous shape is the complementary position by
default, but it can be also specified explicitly. For example:
</para>
<literallayout class="monospaced">
box "A"; box depth 50 join top left to top right "B";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic08.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
There are nine possible joining points &ndash; the four corners, the midpoints of
the four edges, and the centre point. The midpoints of the edges are identified
by the unqualified names of the edges. Thus, if the only joining information is
an edge name, two boxes are joined with the midpoints of the edges aligned:
</para>
<literallayout class="monospaced">
box "A"; box depth 50 join left "B";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic09.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Joins can refer to items other than their immediate predecessors by the use of
<emphasis>labels</emphasis>. For example:
</para>
<literallayout class="monospaced">
BOXA: box "A";
BOXB: box "B";
      circle radius 10 join centre to centre of BOXA;
      box width 20 depth 20 join centre to centre of BOXB;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic10.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The <emphasis role="bold">join</emphasis> option may also be used for specifying how a closed shape joins
onto a line:
</para>
<literallayout class="monospaced">
line; ellipse join top;
</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic11.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
When a circle or an ellipse is being joined, the &#x2018;corner&#x2019; joining points refer
to points on the circumference, not the corners of the bounding box. The size
of an ellipse is specified as a width and a depth, which determine the lengths
of the horizontal and vertical axes. For example:
</para>
<literallayout class="monospaced">
ellipse width 100 depth 20;
ellipse width 20 depth 60;
</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic12.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Lines may be drawn dashed, and, by using the <emphasis role="bold">arrow</emphasis> command, with arrowheads
on one or both ends.
</para>
<literallayout class="monospaced">
line dashed; arrow down; arrow left both;
arrow down back dashed;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic13.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The dash parameters (lengths of lines and gaps) are adjustable (see chapter 
<xref linkend="CHAPENV"/>). By default, <emphasis role="bold">arrow</emphasis> requests an arrowhead on the end of the
line. The option <emphasis role="bold">both</emphasis> gives arrowheads on both ends, whereas <emphasis role="bold">back</emphasis> gives
a backward-pointing arrowhead only.
</para>
<para>
Circular arcs are another form of non-closed shape that Aspic supports. By
default an arc is drawn in an anti-clockwise direction, for 90 degrees, and at
a standard radius (default 36). If an arc follows a line or another arc, it
continues in the same direction by default. If the very first shape is an arc,
its initial direction is upwards.
</para>
<literallayout class="monospaced">
arc "A"; line left; arc "B";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic14.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The options <emphasis role="bold">up</emphasis>, <emphasis role="bold">down</emphasis>, <emphasis role="bold">left</emphasis>, and <emphasis role="bold">right</emphasis> can be used to specify a
different initial direction for the arc:
</para>
<literallayout class="monospaced">
line; arc down;
</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic14a.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The angle subtended, the radius, and clockwise drawing can be specified:
</para>
<literallayout class="monospaced">
arc "A"; arc angle 180 radius 20 "B";
arc clockwise angle 270 radius 40 "C";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic15.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Arcs can be drawn from and to particular points, and, by using the <emphasis role="bold">arcarrow</emphasis>
command, with arrowheads.
</para>
<literallayout class="monospaced">
line; arcarrow from end to start;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic16.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
In this example, the positions &#x2018;end&#x2019; and &#x2018;start&#x2019; are taken to refer to the
last-drawn shape. To refer to other shapes, labels are used:
</para>
<literallayout class="monospaced">
BOXA: box "A"; line; ellipse "E";
arcarrow from top to top of BOXA;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic17.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
When an arc of this type is drawn, <emphasis>either</emphasis> the radius <emphasis>or</emphasis> the angle
subtended at the centre of the arc <emphasis>or</emphasis> the &#x2018;depth&#x2019; of the arc <emphasis>or</emphasis> a point
through which the arc is to pass may be specified, but only one of these. The
&#x2018;depth&#x2019; of an arc is the length of the line from the middle of the arc to the
middle of the line joining the endpoints. If none of the above parameters is
specified, a subtended angle of 90 degrees is used. Here is an example that
shows the different ways of specifying arcs:
</para>
<literallayout class="monospaced">
AA: line;
arc from end to start "1";
arc from end of AA to start of AA angle 180 "2";
arc clockwise from end of AA to start of AA radius 100 "3";
BB: arc to start depth 24 "4";
arc clockwise to start via middle of BB plus (10,-10) "5";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic18.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The fifth arc in this example passes through a point that is defined as
</para>
<literallayout class="monospaced">
middle of BB plus (10,-10)
</literallayout>
<para>
The &#x2018;middle of BB&#x2019; is halfway along the fourth arc; the <emphasis role="bold">plus</emphasis> qualifier
applies a relative offset that is 10 units to the right and 10 down from this
midpoint. The starting and ending points of straight lines can also be
specified explicitly; if both are specified, that determines the length of the
line.
</para>
<literallayout class="monospaced">
AA: line up; BB: line right;
line from middle of AA to middle of BB;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic19.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Positions on a line or arc may be specified as <emphasis role="bold">start</emphasis>, <emphasis role="bold">middle</emphasis>, or
<emphasis role="bold">end</emphasis> (the word <emphasis role="bold">centre</emphasis> is reserved for the centre of a closed shape, or
for the centre point of a circular arc). More precise positioning can be
achieved by specifying a fraction of the way along the line from a named
position:
</para>
<literallayout class="monospaced">
AA: line right 100;
arrow up from 0.2 start of AA;
arrow down from 0.3 end of AA;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic20.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The upward arrow starts at a point that is 0.2 of the way along the line from
the start, and the downward arrow starts at a point that is 0.3 of the way
along the line from the end. This feature also applies to the edges of boxes:
</para>
<literallayout class="monospaced">
AA: box;
arcarrow from 0.1 right of AA to 0.2 top of AA angle 270;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic21.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Positions along the top and bottom are measured from the left; positions on the
sides are measured from the bottom. If these options are used with a circle or
an ellipse, the positions used are those of the circumscribing box. Any
position can be further modified by an explicit distance, specified as a vector
enclosed in parentheses following <emphasis role="bold">plus</emphasis>. In the next example, the arrow
starts at a position 20 to the right of the middle of the line, and 5 above it:
</para>
<literallayout class="monospaced">
line; arrow up from middle plus (20,5);
</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic22.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
There is one further positioning feature that is useful for horizontal or
vertical lines. It allows the end of such a line to be aligned with a given
point, which is often the easiest way to describe certain kinds of drawing:
</para>
<literallayout class="monospaced">
BOXA: box "A";
line down 5; arc; arrow right 10; box "B";
line up align centre of BOXA;
arrow to right of BOXA;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic23.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The <emphasis role="bold">align</emphasis> option is used in place of <emphasis role="bold">to</emphasis>; it defines a position, but
only one of its coordinates is used as a coordinate of the end of the line. In
the example above, a vertical line was specified, and so only the vertical
coordinate of &#x2018;<literal>centre of BOXA</literal>&#x2019; was used.
</para>
<para>
As well as circular arcs, Aspic supports cubic B&egrave;zier curves. An end
point must be supplied for the <emphasis role="bold">curve</emphasis> command; the start is deduced from the
previous shape if not specified. Without any further parameters, the shape is
almost the same as a circular arc. Like circular arcs, the default is to draw
the curve anti-clockwise.
</para>
<literallayout class="monospaced">
A: line down 20 left; line down 20 right; curve to start of A;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic49.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The shape of a cubic B&egrave;zier curve is determined by two control points.
The curve leaves the start in the direction of the first one, and approaches
the end from the direction of the second, but passes through neither of them.
Aspic creates two default control points as follows: in a rotated coordinate
system where the line joining the end points is the x-axis, the first control
point is a quarter of the way along the line and an equal distance from it. The
other control point is in a matching position at the other end of the line.
</para>
<para>
The default control points give an almost circular arc, but the <emphasis role="bold">c1</emphasis> and
<emphasis role="bold">c2</emphasis> options can be used to move the control points. Their argument is a pair
of parenthesized dimensions. The first moves parallel to the joining line, with
a positive value moving further from the end point. The second number moves
away from the line if positive, or nearer if negative. As a convenience, the
<emphasis role="bold">cs</emphasis> option can be used to set both to the same values, thus preserving the
symmetry of the curve. This example shows the positions of the control points:
</para>
<literallayout class="monospaced">
A: line down 20 left; B: line down 20 right; 
curve to start of A cs (-5,30);
line dashed down 5 right 40 from start of A;
circle filled 0 radius 1;
line dashed up 5 right 40 from end of B;
circle filled 0 radius 1;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic50.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
If <emphasis role="bold">c1</emphasis> or <emphasis role="bold">c2</emphasis> is used with <emphasis role="bold">cs</emphasis>, the result is cumulative.
</para>
<literallayout class="monospaced">
A: line down 40; curve to start cs (50,0) c1 (0,100) c2 (25,-10);

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic51.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
If the <emphasis role="bold">wavy</emphasis> option is given, the default position of the second control
point is moved to the opposite side of the curve.
</para>
<literallayout class="monospaced">
line; curve wavy to start;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic52.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Arrowheads are not supported for B&egrave;zier curves. Because their shape can
be so varied, the default position for any text is the middle of the line
joining the end points.
</para>
<para>
Aspic pictures are best specified as a sequence of shapes whose positions are
inter-related. This makes the pictures easy to adjust as they are being
created, and also easy to change subsequently. However, many pictures contain
shapes that are not connected to other shapes in the picture. Aspic does allow
absolute positioning for shapes, but it is often more useful to position these
shapes in relation to the others. This can be done using <emphasis>invisible</emphasis> lines,
boxes, arcs, and curves. If you use <emphasis role="bold">iline</emphasis>, <emphasis role="bold">ibox</emphasis>, <emphasis role="bold">iarc</emphasis>, or
<emphasis role="bold">icurve</emphasis> instead of <emphasis role="bold">line</emphasis>, <emphasis role="bold">box</emphasis>, <emphasis role="bold">arc</emphasis> or <emphasis role="bold">curve</emphasis>, the relevant
lines are not drawn. There are also <emphasis role="bold">icircle</emphasis> and <emphasis role="bold">iellipse</emphasis> commands.
</para>
<literallayout class="monospaced">
box "A"; iline right 30 down 10; box "B";
ibox width 150 "iboxes are helpful" "for centring text";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic24.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The shapes in the examples shown so far have all been just outlines, but Aspic
also contains facilities for causing closed shapes to be filled with colour or
shaded with grey. The commands that define closed shapes (<emphasis role="bold">box</emphasis>, <emphasis role="bold">circle</emphasis>,
and <emphasis role="bold">ellipse</emphasis>) can be specified with a <emphasis role="bold">filled</emphasis> option. If it is followed
by one number, that specifies a grey level. Otherwise, it must be followed by
three numbers that specify a colour in terms of red, green, and blue levels.
The numbers are separated by commas and/or spaces. In all cases, the numbers
lie between 0 and 1. For example:
</para>
<literallayout class="monospaced">
box filled 0.5; circle filled 1 0 0;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic25.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
In this example, visible closed shapes are used, so their outlines are drawn.
If an invisible shape is filled, no outline is drawn.
Filling a shape obliterates items that are &#x2018;beneath&#x2019;
it. To make it easy to specify which filled shapes are &#x2018;above&#x2019; others, there is
a <emphasis role="bold">level</emphasis> option that can be used on any drawing command. The default level
is zero; items with a higher value are drawn &#x2018;above&#x2019; (later), whereas items
with a lower (negative) level are drawn &#x2018;below&#x2019; (earlier). The order in which
the items are defined does not matter. For example:
</para>
<literallayout class="monospaced">
A: circle filled 0.5;
line right from centre of A level 1;
line left from centre of A level -1;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic29.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Arbitrary shapes can be filled by specifying the same <emphasis role="bold">shapefilled</emphasis> option on
a sequence of lines and/or arcs/curves that are all at the same level and have
the same thickness, colour, and dash characteristics. The end of the shape is
marked by an item with different characteristics (or the end of the input). The
shape is automatically closed, if necessary, by an invisible straight edge from
the endpoint to the startpoint. For example:
</para>
<literallayout class="monospaced">
line shapefilled 0.5; arc shapefilled 0.5;
</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic26.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Sometimes it is necessary to supply a dummy item to terminate one shape when
another with the same characteristics follows immediately afterwards. A line of
zero length can be used for this. For example:
</para>
<literallayout class="monospaced">
iline right shapefilled 0.5;
iline down shapefilled 0.5;
line left 0;
iline down left shapefilled 0.5;
iline right shapefilled 0.5;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic27.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Without the dummy, zero-length line, the result is:
</para>
<literallayout class="monospaced">
iline right shapefilled 0.5;
iline down shapefilled 0.5;
iline down left shapefilled 0.5;
iline right shapefilled 0.5;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic28.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
When a long sequence of commands all have the same <emphasis role="bold">shapefilled</emphasis> value, you
can save typing by using the <emphasis role="bold">shapefill</emphasis> command to set a default (see
chapter <xref linkend="CHAPENV"/>).
</para>
<para>
Aspic can be requested to draw a frame round the picture, by means of the
<emphasis role="bold">boundingbox</emphasis> command. A filled frame (see section <xref linkend="SECTBBOX"/>) can be
used to provide a background colour. The <emphasis role="bold">boundingbox</emphasis> command is followed by
a dimension that specifies the space to be left between the bounding box and
the frame. In this example the bounding box of the picture is determined by the
invisible boxes that contain the text:
</para>
<literallayout class="monospaced">
boundingbox 10; ibox "first"; arcarrow; ibox "second";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic30.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
This chapter has introduced many, but not all, of the features of Aspic. The
following chapters specify the form of the input more rigorously, and list each
command, together with its options.
</para>
</chapter>

<chapter>
<title>General operation of Aspic</title>
<para>
Aspic processes its input in order, interpreting commands that are instructions
for moving about on the plane and causing shapes to be drawn and text to be
output. There are many parameters for controlling the size and style of the
shapes that are drawn; all of them have defaults, and most of these can be
altered. Aspic builds up data structures in main memory that represent the
final image. If it reaches the end of the input without finding any errors, it
outputs a description of the picture in the appropriate output language.
</para>
<para>
For PostScript output, the units of length used by Aspic are printers&#x2019;
<emphasis>points</emphasis>, of which there are 72 to an inch. For SVG output, the units are
interpreted by the SVG processor, and on screen displays, they are often taken
as pixels unless a specific size is defined.
</para>
<para>
Aspic distinguishes between closed and open shapes. The closed shapes are
boxes, circles, and ellipses, and the open shapes are lines, circular arcs, and
B&eacute;zier curves. There are default sizes for everything, and text strings
may be associated with each shape. Unless explicitly positioned, each shape is
placed adjacent to its predecessor, in many cases taking note of the <emphasis>current
direction</emphasis>, whose default is to the right. For example, the sequence:
</para>
<literallayout class="monospaced">
box; arrow; box;
</literallayout>
<para>
places the three items in a horizontal row. There are commands to change the
current direction, and, for the drawing commands, options to override it for
individual items.
</para>
<para>
Only very simple pictures can be drawn as a series of shapes in which each
shape is positioned relative to its predecessor. Aspic allows shapes to be
labelled so that branches in the sequence of shapes may be constructed, and
cross-references between different parts of the picture may be expressed. The
previous chapter contains several examples.
</para>
<section>
<title>Position of the coordinate origin</title>
<para>
You can specify absolute positions on the drawing plane, but it is better to
describe a picture in terms of relative positions between the shapes that
comprise it, because such a description is much easier to adjust while you are
creating the picture. If the first item in a picture is specified without an
absolute position &ndash; this is normally the case &ndash; it is positioned as
follows:
</para>
<itemizedlist>
<listitem>
<para>
A closed shape is placed with its centre at the origin.
</para>
</listitem>
<listitem>
<para>
A circular arc is placed with the centre of the arc at the origin.
</para>
</listitem>
<listitem>
<para>
A straight line or B&egrave;zier curve starts at the origin.
</para>
</listitem>
</itemizedlist>
<para>
However, for most pictures, it is not necessary to worry about absolute
coordinates or the position of the origin.
</para>
</section>
<section>
<title>The bounding box</title>
<para>
Aspic computes a bounding box for the entire picture, and arranges that the
bottom left of the bounding box is positioned at the bottom left of the
picture&#x2019;s output. This means that the origin is not necessarily at the bottom
left of the final picture. The coordinates of the bounding box are included in
the output file and are used by programs that process it to determine the size
of the image.
</para>
<para>
Invisible items that are not part of the boundary of a filled shape, and which
have no associated text, are ignored when Aspic is computing the bounding box.
The idea is that such items are assumed to be used for positioning purposes
only. Occasionally you may want an invisible item to be included in the
bounding box calculation. You can do this by providing it with an empty text
string.
</para>
<para>
Because Aspic does not process text strings itself, it can only guess the size
of a string when computing the bounding box. This matters only when a string
extends beyond the box defined by the graphic shapes. A string&#x2019;s width is
guessed as one half the font size times the number of characters in the string.
</para>
</section>
</chapter>

<chapter>
<title>Aspic input</title>
<para>
Aspic input consists of a sequence of commands, each of which must be
terminated by a semicolon. Newlines and other white space may appear between
the components of a command in the usual way. The maximum length of an input
line is 255 bytes. If a sharp (or &#x2018;hash&#x2019;) character (#) is encountered when a
command is expected, the remainder of the input line is ignored. This provides
a facility for including comments in Aspic input. Each input line is processed
for variable substitutions before any other processing takes place (see chapter
<xref linkend="CHAPVARIABLE"/> below). This action can be disabled by the <emphasis role="bold">-nv</emphasis> command
line option.
</para>
<section>
<title>Command format</title>
<para>
An Aspic command consists of four components:
</para>
<informaltable frame="none">
<tgroup cols="4" colsep="0" rowsep="0">
<colspec colwidth="40" align="centre"/>
<colspec colwidth="60" align="centre"/>
<colspec colwidth="120" align="centre"/>
<colspec colwidth="140" align="centre"/>
<tbody>
<row>
<entry><emphasis>label</emphasis></entry>
<entry><emphasis>command</emphasis></entry>
<entry><emphasis>options</emphasis></entry>
<entry><emphasis>strings</emphasis></entry>
</row>
<row>
<entry><literal>A:</literal></entry>
<entry><literal>box</literal></entry>
<entry><literal>dashed width 100</literal></entry>
<entry><literal>"first" "second";</literal></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
The case of letters is significant in all the components. Only the command name
is mandatory.
</para>
<itemizedlist>
<listitem>
<para>
Commands that draw shapes may start with one or more labels, each terminated by
a colon. A label consists of a sequence of letters and digits, starting with a
letter. Upper case letters are commonly used in labels as it makes them stand
out. Other commands may not be labelled. Labels must be unique. For commands
inside macros, the special sequence <literal>&amp;$</literal> can be used to ensure uniqueness
(see <xref linkend="CHAPMACRO"/>).
</para>
</listitem>
<listitem>
<para>
Many commands have option specifications that follow the command name. Each
option consists of a keyword, possibly followed by one or more data items. The
options may appear in any order, and except in a few special cases are all
optional.
</para>
</listitem>
<listitem>
<para>
Following the options, on commands that define lines or closed shapes, and on
the <emphasis role="bold">text</emphasis> command, there may be any number of text strings, each enclosed in
double quotes. The double-quote character itself may be included by doubling.
There are some options that can follow a text string; these are described in
chapter <xref linkend="CHAPOBJTEXT"/>. The strings specify text that is to be output at an
appropriate position, relative to the item that is drawn for all but the
<emphasis role="bold">text</emphasis> command, which has special positioning arrangements. Details of text
positioning are given below with each command. Strings may not extend over line
boundaries in the input.
</para>
</listitem>
<listitem>
<para>
Strings are interpreted as a sequence of Unicode characters. The inclusion of
characters by name and by number is supported. Details of how the sequence of
input bytes is decoded are given in section <xref linkend="SECTCODES"/>. Aspic does no
typographic processing of strings. This means that any string-specific
processing, such as measuring the string in order to centre it, has to take
place in the backend processor. In PostScript output, PostScript operators are
used to do this. In SVG output, an appropriate setting of the <emphasis role="bold">text-anchor</emphasis>
attribute is generated.
</para>
</listitem>
</itemizedlist>
<para>
A number of command words and option names use the British English spellings
&#x2018;centre&#x2019;, &#x2018;grey&#x2019; and &#x2018;colour&#x2019;. In all cases the American spellings &#x2018;center&#x2019;,
&#x2018;gray&#x2019; and &#x2018;color&#x2019; are also accepted.
</para>
</section>
<section>
<title>File inclusion</title>
<para>
The <emphasis role="bold">include</emphasis> command can be used to insert the contents of a given file into
the sequence of Aspic commands. This can be used, for example, to include a
standard header file (which might define fonts or give names to colours) in a
number of different pictures. The command name is followed by a file name,
which is not quoted. For example:
</para>
<literallayout class="monospaced">
include /home/me/MyAspicHeader;
</literallayout>
<para>
The <emphasis role="bold">include</emphasis> command may not appear inside a macro (see chapter
<xref linkend="CHAPMACRO"/>), but included files may contain further inclusions.
</para>
</section>
</chapter>

<chapter id="CHAPVARIABLE">
<title>Aspic variables</title>
<para>
Aspic supports simple variables, which can be used to save repetition in the
input. This feature can, however, be disabled by use of the <emphasis role="bold">-nv</emphasis> command
line option. If you are not using Aspic variables, but are making use of dollar
($) characters in strings, you should use <emphasis role="bold">-nv</emphasis>, because otherwise the
dollars will be misinterpreted by Aspic.
</para>
<para>
When variables are not disabled, a dollar character in an input line introduces
a variable substitution. There is, however, one exception: the special sequence
<literal>&amp;$</literal> that is used in Aspic macros &ndash; see chapter <xref linkend="CHAPMACRO"/>.
In all other cases, a dollar character must either be followed by another
dollar (indicating a single literal dollar character), or be followed by a
variable name, optionally enclosed in braces (curly brackets). Variable names
start with a letter and contain letters and digits. Braces are required if the
character that follows the variable name is a letter or a digit.
</para>
<para>
When each input line is read, the values of any variables that are mentioned
are substituted before any other processing takes place. A variable must be
defined before it is used. The contents of a macro (see chapter
<xref linkend="CHAPMACRO"/>) are processed for variable substitutions when the macro is
defined, not when it is called.
</para>
<para>
Variables are given values by means of the <emphasis role="bold">set</emphasis> command, which is followed
by a variable name (without a dollar) and a string value. The value of a
variable can be changed as many times as you like during the course of a
picture description. For example, this command defines the variable <emphasis role="bold">red</emphasis> to
contain the three colour values for the colour red:
</para>
<literallayout class="monospaced">
set red "1,0,0";
</literallayout>
<para>
Later in the input file, the variable could be used like this:
</para>
<literallayout class="monospaced">
box filled $red;
</literallayout>
<para>
At the start of an Aspic run, the variable <emphasis role="bold">$date</emphasis> is initialized to contain
the date and time, and the variables <emphasis role="bold">$creator</emphasis> and <emphasis role="bold">$title</emphasis> are each set
to the string &#x2018;Unknown&#x2019;. These three variables are used to create comments at
the start of the output, but otherwise they are treated like any other
variable, and you can change them as required. For example, you might like to
set <emphasis role="bold">$date</emphasis> to the date on which the picture was defined.
</para>
</chapter>

<chapter id="CHAPMACRO">
<title>Aspic macros</title>
<para>
To save a lot of command repetition, Aspic contains a simple macro facility
that allows you to define compound commands. A macro is defined by the command
<emphasis role="bold">macro</emphasis>, which is followed by a name and a macro body. The name must not be
the same as the name of any inbuilt command. If it is the same as a previously
defined macro, the new macro overrides. The body consists of <emphasis>either</emphasis> all the
following text up to the first non-quoted semicolon, <emphasis>or</emphasis>, if the first
character after the name is an opening brace, all the text up to the next
non-quoted closing brace, which must be followed by a semicolon to terminate
the <emphasis role="bold">macro</emphasis> command. For example:
</para>
<literallayout class="monospaced">
macro bigbox box width 100 depth 100;
macro box2 { box; box; };
</literallayout>
<para>
In the first example, the terminating semicolon is not part of the macro body.
A macro definition may extend over more than one line. Variables are
substituted into the body of a macro when it is defined; there is no
re-substitution when the macro is called. If you need such a facility, it can
be obtained by passing variables as arguments to macro calls.
</para>
<para>
Macros are called by using their names as command names. A macro body may
contain calls to other macros, but recursion is not allowed. Macros can be
called with arguments, which are treated as character strings. White space is
used to delimit macro arguments, unless they are enclosed in either single or
double quotes. If double quotes are used, they are retained when the contents
of an argument are substituted into the macro body.
</para>
<para>
Macro arguments are referenced in the macro body by items of the form <literal>&amp;1</literal>,
<literal>&amp;2</literal>, etc. These references are replaced by the actual argument values each
time the macro is called. If the character <literal>&amp;</literal> is required for another
purpose in a macro body, it must be doubled. If the special string <literal>&amp;$</literal>
appears in a macro body, it is replaced throughout by a sequence number that is
incremented for each macro call. This can be used to generate unique labels for
shapes that are drawn in macro bodies. A nested macro call will have a
different value for <literal>&amp;$</literal>.
</para>
<para>
The following example starts with the definition of a macro that draws a box
containing text given as one or two arguments, with two lines attached to it.
This macro is then used to generate an array of boxes. Because Aspic allows
multiple labels on shapes, these compound items can themselves be labelled, as
shown in this example:
</para>
<literallayout class="monospaced">
macro item {
  B&amp;$: box &amp;1 &amp;2; line down;
  line right 20 from right of B&amp;$;
  };

item "first" "second";
MID: item "third";
item "fourth" "fifth";
arrow up 20 from MID;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic31.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Note the use of <literal>&amp;$</literal> to generate a unique label within the macro. When an
macro call is labelled, the first command inside the macro must be a command
for which a label is allowed, that is, it must draw something.
</para>
<para>
Because the macro in the example above was not defined with double quotes
surrounding the argument references, double quotes had to be used when calling
it in order to supply strings to the <emphasis role="bold">box</emphasis> command. If the quotes had been
present in the definition, they could not be have been used in the calls, but
single quotes could have been used if the arguments contained spaces.
</para>
<para>
If an argument that has not been supplied is referenced, nothing is
substituted; thus the second call of <emphasis role="bold">item</emphasis> above expands into a call to
<emphasis role="bold">box</emphasis> with only a single string argument. If too many arguments are supplied,
the surplus ones are left in the input following the substituted text.
</para>
<para>
It is not necessary to include a semicolon before a terminating brace when
defining a macro. If the semicolon is present, it is included in the
replacement text when the macro is called. Sometimes it is useful to be able to
set up a macro that generates part of a command, so that additional options
can be added on each call. This can be done by omitting the terminating
semicolon. In this example, any text following the macro name is added to the
command:
</para>
<literallayout class="monospaced">
macro slotbox { box width 200 depth 20 };
slotbox dashed "text for slotbox";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic32.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
When such additional text is required, and also not all the arguments of a
macro are to be supplied, the vertical bar character can be used to mark the
end of the arguments. For example:
</para>
<literallayout class="monospaced">
macro dashbox { box dashed &amp;1 &amp;2; arrow };
dashbox "first" "second";
dashbox "third" | "fourth";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic33.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
In the first call, the two strings are taken as arguments of the macro; in the
second call, the second string is added onto the end of the replacement text,
and therefore goes with the <emphasis role="bold">arrow</emphasis> command.
</para>
</chapter>

<chapter id="CHAPTOV">
<title>Types of value used in commands</title>
<para>
Unless explicitly stated to be an integer, a number may always be specified
with an optional decimal point and fractional part. Negative numbers are
preceded by a minus sign. Non-integer numbers are held in a fixed-point format
to three decimal places. In the descriptions of the commands that follow, the
following types of value are used:
</para>
<section>
<title>&lt;angle&gt;</title>
<para>
A non-negative number, specifying an angle in degrees.
</para>
</section>
<section>
<title>&lt;boxpoint&gt;</title>
<para>
One of the phrases <emphasis>top, bottom, left, right, centre, bottom left, bottom
right, top left</emphasis>, or <emphasis>top right</emphasis>. The first four refer to the midpoints of
the respective sides of a box; the last four refer to the corners.
</para>
</section>
<section>
<title>&lt;colour&gt;</title>
<para>
Three numbers in the range 0.0 to 1.0, separated by spaces and/or commas. They
specify a colour by the amount of red, green, and blue, respectively, with 0.0
meaning none and 1.0 the maximum amount of each component.
</para>
</section>
<section>
<title>&lt;greylevel&gt;</title>
<para>
A number in the range 0.0 to 1.0, where 0.0 is black and 1.0 is white.
</para>
</section>
<section>
<title>&lt;integer&gt;</title>
<para>
A positive or negative integer.
</para>
</section>
<section>
<title>&lt;label&gt;</title>
<para>
A label that identifies an existing drawing item, that is, one whose definition
falls earlier in the input file.
</para>
</section>
<section>
<title>&lt;length&gt;</title>
<para>
A non-negative number, specifying a length.
</para>
</section>
<section>
<title>&lt;position&gt;</title>
<para>
A &lt;<emphasis>position</emphasis>&gt; identifies a point in the plane. It is either an absolute
position, specified as a pair of x-y coordinates, separated by a comma and
enclosed in parentheses, or a relative position, specified as follows:
</para>
<literallayout>
[&lt;<emphasis>fraction</emphasis>&gt;] &nbsp; &lt;<emphasis>point</emphasis>&gt; &nbsp; [<literal>of</literal> &lt;<emphasis>label</emphasis>&gt;] &nbsp; [<literal>plus</literal> &lt;<emphasis>vector</emphasis>&gt;]
</literallayout>
<para>
where all but &lt;<emphasis>point</emphasis>&gt; are optional. The position is computed relative to
the shape whose &lt;<emphasis>label</emphasis>&gt; is given, or if no &lt;<emphasis>label</emphasis>&gt; is mentioned,
relative to the previous drawn shape.
</para>
<itemizedlist>
<listitem>
<para>
If the referenced shape is a box, circle, or ellipse, &lt;<emphasis>point</emphasis>&gt; must be a
&lt;<emphasis>boxpoint</emphasis>&gt;. The &#x2018;corner&#x2019; points of a circle or ellipse are the
intersections of the shape with the diagonals of the bounding box.
</para>
</listitem>
<listitem>
<para>
If the referenced shape is an arc, curve, or line, &lt;<emphasis>point</emphasis>&gt; is one of the
words <emphasis>start, end</emphasis>, or <emphasis>middle</emphasis>. These refer to positions along the arc,
curve, or line. In addition, for an arc, <emphasis>centre</emphasis>, meaning the centre of the
circle of which the arc is part, may be specified.
</para>
</listitem>
<listitem>
<para>
If there is no referenced shape, this form of &lt;<emphasis>position</emphasis>&gt; causes an error.
</para>
</listitem>
</itemizedlist>
<para>
&lt;<emphasis>fraction</emphasis>&gt; is a number between 0.0 and 1.0, specified either as a decimal
fraction (for example, 0.5) or as two numbers (usually, but not necessarily
integers) separated by a slash (for example, 1/3). It specifies a position
part-way along a line, arc, or curve.
If &lt;<emphasis>fraction</emphasis>&gt; is present,
there are some additional constraints on &lt;<emphasis>point</emphasis>&gt;:
</para>
<itemizedlist>
<listitem>
<para>
If the referenced object is closed, then &lt;<emphasis>point</emphasis>&gt; must be one of
<emphasis>top, bottom, left</emphasis>, or <emphasis>right</emphasis>, and the line to which &lt;<emphasis>fraction</emphasis>&gt;
refers is the appropriate side of the bounding box of the object. The fraction
is measured from the left of horizontal lines, and from the bottom of vertical
lines.
</para>
</listitem>
<listitem>
<para>
If the referenced object is not closed, then &lt;<emphasis>point</emphasis>&gt; must be <emphasis>start</emphasis> or
<emphasis>end</emphasis> &ndash; the fraction is taken from that end of the line, arc, or curve.
</para>
</listitem>
</itemizedlist>
<para>
In effect, the presence of &lt;<emphasis>fraction</emphasis>&gt; changes the meaning of <emphasis>top,
bottom, left</emphasis>, or <emphasis>right</emphasis> as a &lt;<emphasis>point</emphasis>&gt;. With no &lt;<emphasis>fraction</emphasis>&gt;, these
words refer to the midpoints of the respective sides of the bounding box; when
&lt;<emphasis>fraction</emphasis>&gt; is present, they refer to the sides themselves.
</para>
<para>
The final optional component of a &lt;<emphasis>position</emphasis>&gt; is the word <literal>plus</literal> followed
by a &lt;<emphasis>vector</emphasis>&gt;, which is two numbers separated by a comma and enclosed in
parentheses. It specifies a Cartesian adjustment to the position defined by the
remainder of the &lt;<emphasis>position</emphasis>&gt;. Here are some examples of &lt;<emphasis>position</emphasis>&gt;
specifications:
</para>
<literallayout class="monospaced">
(45,67)
top
top plus (10,0)
centre of A
bottom right of B plus (0,-5)
1/3 top of C
middle
end of line1
0.25 start of line3 plus (0,7)
</literallayout>
</section>
</chapter>

<chapter id="CHAPOBJTEXT">
<title>Drawing objects and text</title>
<para>
All the commands that cause something to be drawn and/or text to be output are
described in this chapter. Each command is summarised by listing its options
and the type of value that must follow each option keyword, where relevant. A
value type that is followed by an asterisk is optional, and a vertical bar is
used to separate alternative value types. Some combinations of options are
mutually exclusive, and these are noted in the description of each command
below.
</para>
<para>
When a command does not specify an option, a default value is used. There are
separate sets of defaults for boxes, circles, ellipses, and lines (both
straight and curved). Many of these defaults can be changed by the commands
that are described in chapter <xref linkend="CHAPENV"/> (<emphasis>Changing environment
parameters</emphasis>).
</para>
<para>
The <emphasis role="bold">thickness</emphasis>, <emphasis role="bold">dashed</emphasis>, <emphasis role="bold">colour</emphasis>, and <emphasis role="bold">grey</emphasis> options are common to
all these commands except <emphasis role="bold">text</emphasis>. The first specifies the thickness of lines
that are drawn. If <emphasis role="bold">dashed</emphasis> is specified, lines are drawn dashed, with the
lengths of dashes and spaces controlled by the relevent setting in the current
environment (see chapter <xref linkend="CHAPENV"/>). The colour of lines is specified
either by <emphasis role="bold">colour</emphasis>, which must be followed by three numbers (for red, blue,
and green components), or by <emphasis role="bold">grey</emphasis>, which must be followed by a single
number. This is a shorthand for <emphasis role="bold">colour</emphasis> followed by three identical numbers.
The obsolete synonym <emphasis role="bold">greyness</emphasis> is also supported. Colour numbers lie in the
range 0.0. to 1.0 inclusive. They specify the amount of colour to be used. In
the case of <emphasis role="bold">grey</emphasis>, a value of 0.0 is black and 1.0 is white. If no colour
option is present, default values are used.
</para>
<para>
The <emphasis role="bold">level</emphasis> option is common to all these commands (including <emphasis role="bold">text</emphasis>). It
is useful when filled shapes are being drawn, because filling a shape
obliterates items that are drawn &#x2018;below&#x2019; it. The default level is zero; items
on levels greater than zero are drawn &#x2018;above&#x2019; and items with levels less than
zero are drawn &#x2018;below&#x2019;. The default can be changed by the <emphasis role="bold">level</emphasis> command
(see chapter <xref linkend="CHAPENV"/>).
</para>
<para>
Many of the commands also have <emphasis role="bold">filled</emphasis> and <emphasis role="bold">shapefilled</emphasis> options. For
closed shapes (<emphasis role="bold">box</emphasis>, <emphasis role="bold">circle</emphasis>, <emphasis role="bold">ellipse</emphasis>), <emphasis role="bold">filled</emphasis> specifies a colour
with which to fill the shape. It can be followed either by three numbers to
specify red, green, and blue components, or by a single number, to specify a
grey level. For lines or arcs that start or end with arrowheads, <emphasis role="bold">filled</emphasis>
specifies the colour with which the arrowhead is filled.
</para>
<para>
The <emphasis role="bold">shapefilled</emphasis> option also takes either one or three numbers as its
argument. It is available on commands for drawing lines, arcs, and curves. A
sequence of such commands with the same <emphasis role="bold">shapefilled</emphasis> values, and also the
same thickness, dash, colour, and level parameters, is interpreted as a closed
shape that is to be filled with the appropriate colour. If the lines do not
define a closed shape, an invisible straight line from the end to the start
bounds the area that is filled. If one such closed shape immediately follows
another with the same characteristics, you may need to insert a dummy command
without a <emphasis role="bold">shapefilled</emphasis> option, in order to terminate the first shape. A line
of length zero can be used for this.
</para>
<para>
Options may be specified in any order, and may be followed by any number of
strings enclosed in double quotes (with doubling for any double quotes within
the string), followed optionally by a &lt;<emphasis>vector</emphasis>&gt; (as described above in the
definition of &lt;<emphasis>position</emphasis>&gt;) and one of <literal>/l</literal> (the letter ell), <literal>/r</literal>, or
<literal>/c</literal>. If present, the &lt;<emphasis>vector</emphasis>&gt; must come first. For example:
</para>
<literallayout class="monospaced">
"the quick brown fox"
"move this up"(0,20)
"justify right"/r
"move left and centre"(-20,0)/c
</literallayout>
<para>
The presence of a &lt;<emphasis>vector</emphasis>&gt; causes the position at which the string is
output to be modified by the value of the &lt;<emphasis>vector</emphasis>&gt;. The <literal>/l</literal>, <literal>/r</literal>, and
<literal>/c</literal> options specify left, right, or centre justification respectively, with
respect to this position. The default justification depends on the shape with
which the string is associated, and is documented below. Other options may also
be present, separated by slashes:
</para>
<itemizedlist>
<listitem>
<para>
An sequence of digits is interpreted as a font number for this string. A
default font, 12-point Times-Roman, is provided, numbered zero, The
<emphasis role="bold">bindfont</emphasis> command can be used to define additional fonts, and the
<emphasis role="bold">setfont</emphasis> command can be used to change the default font. For further details
of these commands, see chapter <xref linkend="CHAPFONT"/>, and for details of character
codes, see section <xref linkend="SECTCODES"/>.
</para>
</listitem>
<listitem>
<para>
A number preceded by a plus or a minus sign is interpreted as an angle of
rotation, in degrees. Positive rotation is anticlockwise. The centre of
rotation is the defining position for the string, on the baseline. For
left-justified strings it is at the left, for centred strings in the middle,
and for right-justified strings at the right.
</para>
</listitem>
<listitem>
<para>
A single unsigned number that contains a decimal point is interpreted as a grey
level for the text. The value must not be greater than 1.0.
</para>
</listitem>
<listitem>
<para>
Three comma-separated numbers are interpreted as the red, green, and blue
components of a colour for the text. The values must not be greater than 1.0.
</para>
</listitem>
</itemizedlist>
<para>
Here are some examples:
</para>
<literallayout class="monospaced">
"the quick (font 2)"/2 "brown fox (font 5)"/5
"move left and centre (font 3)"(-20,0)/c/3
"coloured and rotated"/1,0.5,0.4/+45
</literallayout>
<para>
When a command is followed by more than one string, each successive string is
placed &#x2018;below&#x2019; the previous one. In the case of a rotated string, &#x2018;below&#x2019; takes
the rotation into account. Strings that have no rotation specified adopt the
rotation of their predecessor.
</para>
<literallayout class="monospaced">
bindfont 1 "Times-Roman" 30;
bindfont 2 "Times-Italic" 30;
text "One"/1,0,0/+45/1 "Two"/2 "Three"/1/0,1,0;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic53.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<section>
<title>arc</title>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="72" align="left"/>
<colspec colwidth="200" align="left"/>
<tbody>
<row>
<entry></entry>
<entry><emphasis role="bold">angle</emphasis></entry>
<entry>&lt;<emphasis>angle</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">clockwise</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">colour</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">dashed</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">down</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">depth</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">from</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>label</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">grey</emphasis></entry>
<entry>&lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">left</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">level</emphasis></entry>
<entry>&lt;<emphasis>integer</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">radius</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">right</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">shapefilled</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">thickness</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">to</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">up</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">via</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
A circular arc is drawn in an anti-clockwise direction from its starting point
to its ending point, unless the <emphasis role="bold">clockwise</emphasis> option is present, in which case
the arc is drawn clockwise. The position, size, and orientation of an arc may
be specified in one of four different ways:
</para>
<orderedlist numeration="arabic">
<listitem>
<para>
If neither <emphasis role="bold">from</emphasis> nor <emphasis role="bold">to</emphasis> is specified, the arc is positioned according to
the previously drawn shape. The <emphasis role="bold">depth</emphasis> and <emphasis role="bold">via</emphasis> options may not be given.
The user may supply either or both of a radius and an angle. If no radius is
supplied, the default arc radius is used; if no angle is supplied, an arc of 90
degrees is drawn.
</para>
<para>
The initial direction of the arc can be specified by <emphasis role="bold">up</emphasis>, <emphasis role="bold">down</emphasis>,
<emphasis role="bold">left</emphasis>, or <emphasis role="bold">right</emphasis>. If none of these are present, and the previous item was
a line or arc, the new arc starts by continuing in the same direction.
When an arc follows a closed shape (box, circle, or ellipse), the current
direction is used. The direction determines the position on the closed shape
from which the arc starts (<emphasis role="bold">up</emphasis> starts from the middle of the top of a box,
and so on). If the first item in the input is an arc without an explicit
direction, it is drawn upwards.
</para>
</listitem>
<listitem>
<para>
If <emphasis role="bold">from</emphasis> is supplied without <emphasis role="bold">to</emphasis>, either or both of a radius and an angle
may be supplied. If no radius is supplied, the default arc radius is used; if
no angle is supplied, an arc of 90 degrees is drawn. The <emphasis role="bold">depth</emphasis> and <emphasis role="bold">via</emphasis>
options may not be given. If the initial direction of the arc is not specified,
the current direction is used.
</para>
</listitem>
<listitem>
<para>
If <emphasis role="bold">to</emphasis> is given without <emphasis role="bold">from</emphasis>, a starting point is determined from the
previous shape, and then the action is as described in the following paragraph.
If the previous shape is a line, arc, or curve, its end point is used;
otherwise the direction (explicit or implicit) is used to decide on which side
of the bounding box of the previous closed shape to place the starting point,
but not for any other purpose. The midpoint of the appropriate side is used.
</para>
</listitem>
<listitem>
<para>
If both <emphasis role="bold">from</emphasis> and <emphasis role="bold">to</emphasis> are given (or if <emphasis role="bold">to</emphasis> is given and <emphasis role="bold">from</emphasis> is
determined from the previous shape as just described), there are four mutually
exclusive ways in which the size of the arc can be specified:
</para>
<orderedlist numeration="loweralpha">
<listitem>
<para>
The <emphasis role="bold">radius</emphasis> option can be used to give an explicit radius; this must not be
less than half the distance between the end points.
</para>
</listitem>
<listitem>
<para>
The <emphasis role="bold">angle</emphasis> option can be used to specify the angle subtended at the centre of
the arc.
</para>
</listitem>
<listitem>
<para>
The <emphasis role="bold">depth</emphasis> option can be used to specify the distance between the midpoint of
the line joining the end points and the midpoint of the arc. If the <emphasis role="bold">depth</emphasis>
option specifies a distance that is more than half the distance between the end
points, an arc of more than 180 degrees is drawn.
</para>
</listitem>
<listitem>
<para>
The <emphasis role="bold">via</emphasis> option can be used to specify a third point through which the arc
is to pass. This point must not be be on the line joining the end points, and
it must also be on the appropriate side of that line. If it is not suitable, an
error message is output.
</para>
</listitem>
</orderedlist>
<para>
If none of these options is given, an arc that subtends 90 degrees at its
centre is drawn. If more than one of these options is given, an error message
is generated.
</para>
</listitem>
</orderedlist>
<para>
If the <emphasis role="bold">from</emphasis> option specifies the label of a closed shape without further
qualification, the actual starting point on that shape is determined by
the initial direction of the arc.
</para>
<para>
Texts are output near the midpoint of the arc, and are left-justified by
default. The following example illustrates various types of arc:
</para>
<literallayout class="monospaced">
A: arc "A";
B: arc clockwise radius 20 angle 180 "B";
C: arc dashed from start of A to end of B angle 190 "C";
arc clockwise dashed from start of A to end of A radius 75 "D";
arc to start depth 30 "E";
arc clockwise to middle of C via middle of A "F";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic34.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
</section>
<section>
<title>arcarrow</title>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="72" align="left"/>
<colspec colwidth="200" align="left"/>
<tbody>
<row>
<entry></entry>
<entry><emphasis role="bold">angle</emphasis></entry>
<entry>&lt;<emphasis>angle</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">back</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">both</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">clockwise</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">colour</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">dashed</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">depth</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">down</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">filled</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">from</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>label</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">grey</emphasis></entry>
<entry>&lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">left</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">level</emphasis></entry>
<entry>&lt;<emphasis>integer</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">radius</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">right</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">shapefilled</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">thickness</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">to</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">up</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">via</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
The options for <emphasis role="bold">arcarrow</emphasis> are exactly as for <emphasis role="bold">arc</emphasis>, but with the addition
of <emphasis role="bold">filled</emphasis> (specifying a filled arrowhead), <emphasis role="bold">both</emphasis> (which specifies a
double-headed arrow) and <emphasis role="bold">back</emphasis> (which specifies a backwards-pointing arrow).
If neither <emphasis role="bold">both</emphasis> nor <emphasis role="bold">back</emphasis> is given, an arrowhead is drawn at the end of
the arc.
Arrowheads are drawn within the length of the arc so if, for example, a
90-degree arc is drawn from absolute angle zero, the arrow head is not
horizontal:
</para>
<literallayout class="monospaced">
arcarrow;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic35.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
A horizontal arrowhead can be drawn by adding a short linear arrow afterwards,
but note that this extends beyond the end of the arc:
</para>
<literallayout class="monospaced">
arc; arrow left 10;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic36.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
</section>
<section>
<title>arrow</title>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="72" align="left"/>
<colspec colwidth="200" align="left"/>
<tbody>
<row>
<entry></entry>
<entry><emphasis role="bold">align</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">back</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">both</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">colour</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">dashed</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">down</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;*</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">filled</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">from</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>label</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">grey</emphasis></entry>
<entry>&lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">left</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;*</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">level</emphasis></entry>
<entry>&lt;<emphasis>integer</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">right</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;*</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">shapefilled</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">thickness</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">to</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">up</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;*</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
The <emphasis role="bold">arrow</emphasis> command has exactly the same options as <emphasis role="bold">line</emphasis> (see section
<xref linkend="SECTLINE"/> below), but with the addition of <emphasis role="bold">filled</emphasis> (specifying a filled
arrowhead), <emphasis role="bold">both</emphasis> (specifying a double-headed arrow), and <emphasis role="bold">back</emphasis>
(specifying a backwards-pointing arrow). If neither <emphasis role="bold">both</emphasis> nor <emphasis role="bold">back</emphasis> is
given, an arrowhead is drawn at the end of the line.
</para>
</section>
<section id="SECTBOX">
<title>box</title>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="72" align="left"/>
<colspec colwidth="200" align="left"/>
<tbody>
<row>
<entry></entry>
<entry><emphasis role="bold">at</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">colour</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">dashed</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">depth</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">filled</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">grey</emphasis></entry>
<entry>&lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">level</emphasis></entry>
<entry>&lt;<emphasis>integer</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">join</emphasis></entry>
<entry>&lt;<emphasis>boxpoint</emphasis>&gt; &nbsp; to &lt;<emphasis>position</emphasis>&gt; &nbsp; | &nbsp; to &lt;<emphasis>label</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">thickness</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">width</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
This command causes a rectangular closed box to be drawn. The <emphasis role="bold">width</emphasis> and
<emphasis role="bold">depth</emphasis> options specify the horizontal and vertical dimensions of the box.
The <emphasis role="bold">at</emphasis> option specifies the position of the centre of the box; if not
given, the centre point is computed by reference to the previous shape. In the
absence of a <emphasis role="bold">join</emphasis> option, if the previous shape was a line or arc, the
midpoint of an appropriate side of the box is joined onto its end. If the
previous item was a B&egrave;zier curve, the midpoint of the box is positioned
at the end of the curve. If the previous item was a closed shape, the side
which is abutted depends on the current direction. If there was no previous
shape, the centre is placed at the origin of the coordinate system.
</para>
<para>
The <emphasis role="bold">join</emphasis> option specifies how the box is to be joined to a previous shape,
and is mutually exclusive with <emphasis role="bold">at</emphasis>. This option takes three different forms:
</para>
<orderedlist numeration="arabic">
<listitem>
<para>
If &lt;<emphasis>position</emphasis>&gt; is given, the given point on the box is placed at the given
position. For example:
</para>
<literallayout class="monospaced">
box join bottom right to centre of C;
box join top left to start plus (10,15);
</literallayout>
<para>
As with all &lt;<emphasis>positions</emphasis>&gt;, if &#x2018;of &lt;<emphasis>label</emphasis>&gt;&#x2019; is omitted, the preceding
shape is implied.
</para>
</listitem>
<listitem>
<para>
If no &lt;<emphasis>position</emphasis>&gt; is given, and the previous shape (or the named shape if
&#x2018;to &lt;<emphasis>label</emphasis>&gt;&#x2019; is present) is a closed shape, the given point is joined to
the complementary point of the referenced shape. For example:
</para>
<literallayout class="monospaced">
box join top;
box join top left to A;
</literallayout>
</listitem>
<listitem>
<para>
If no &lt;<emphasis>position</emphasis>&gt; is given, and the previous shape (or the named shape if
&#x2018;to &lt;<emphasis>label</emphasis>&gt;&#x2019; is present) is not a closed shape, the given point is
joined to its end.
</para>
</listitem>
</orderedlist>
<para>
Note that if boxes of different dimensions are joined by naming their edges,
the middle points of the edges are made coincident:
</para>
<literallayout class="monospaced">
box "A"; box depth 50 "B";
box width 50 join top "C";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic37.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Any text items are centred at the centre of the box. Because Aspic does not
process the text itself, it cannot tell whether the text will actually fit into
the box.
</para>
</section>
<section>
<title>circle</title>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="72" align="left"/>
<colspec colwidth="200" align="left"/>
<tbody>
<row>
<entry></entry>
<entry><emphasis role="bold">at</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">colour</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">dashed</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">filled</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">grey</emphasis></entry>
<entry>&lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">level</emphasis></entry>
<entry>&lt;<emphasis>integer</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">join</emphasis></entry>
<entry>&lt;<emphasis>boxpoint</emphasis>&gt; &nbsp; to &nbsp; &lt;<emphasis>position</emphasis>&gt; &nbsp; | &nbsp; to &lt;<emphasis>label</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">radius</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">thickness</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
The <emphasis role="bold">at</emphasis> option specifies the position of the centre of the circle; it is
mutually exclusive with the <emphasis role="bold">join</emphasis> option, which specifies how the circle is
to be joined to the previous shape, exactly as for boxes (see above). Text
items are centred at the centre of the circle.
</para>
</section>
<section>
<title>curve</title>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="72" align="left"/>
<colspec colwidth="200" align="left"/>
<tbody>
<row>
<entry></entry>
<entry><emphasis role="bold">c1</emphasis></entry>
<entry>&lt;<emphasis>vector</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">c2</emphasis></entry>
<entry>&lt;<emphasis>vector</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">clockwise</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">colour</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">cs</emphasis></entry>
<entry>&lt;<emphasis>vector</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">dashed</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">from</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>label</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">grey</emphasis></entry>
<entry>&lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">level</emphasis></entry>
<entry>&lt;<emphasis>integer</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">shapefilled</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">thickness</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">to</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">wavy</emphasis></entry>
<entry></entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
This command draws a B&egrave;zier curve; the <emphasis role="bold">to</emphasis> option is mandatory. If
<emphasis role="bold">from</emphasis> is not given, it is deduced from the previous item. The <emphasis role="bold">c1</emphasis> and
<emphasis role="bold">c2</emphasis> options define adjustments to the curve&#x2019;s control points. The first
number moves parallel to the line joining the endpoints, positive values moving
away from the relevant end. The second number moves in a perpendicular
direction, positive values moving further away from the joining line. The
<emphasis role="bold">cs</emphasis> option applies to both control points and is cumulative with <emphasis role="bold">c1</emphasis> and
<emphasis role="bold">c2</emphasis>. The <emphasis role="bold">wavy</emphasis> option moves the second control point to an equal distance
on the opposite side of the base line. Text items are placed at the middle of
the base line.
</para>
</section>
<section>
<title>ellipse</title>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="72" align="left"/>
<colspec colwidth="200" align="left"/>
<tbody>
<row>
<entry></entry>
<entry><emphasis role="bold">at</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">colour</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">dashed</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">depth</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">filled</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">grey</emphasis></entry>
<entry>&lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">level</emphasis></entry>
<entry>&lt;<emphasis>integer</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">join</emphasis></entry>
<entry>&lt;<emphasis>boxpoint</emphasis>&gt; &nbsp; to &nbsp; &lt;<emphasis>position</emphasis>&gt; &nbsp; | &nbsp; to &lt;<emphasis>label</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">thickness</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">width</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
The options for <emphasis role="bold">ellipse</emphasis> are the same as for <emphasis role="bold">circle</emphasis>, except that
<emphasis role="bold">radius</emphasis> is replaced by <emphasis role="bold">width</emphasis> and <emphasis role="bold">depth</emphasis>, which specify the lengths of
the horizontal and vertical axes. That is, they specify the size of the
bounding box.
</para>
</section>
<section>
<title>iarc</title>
<literallayout>
&lt;<emphasis>as arc</emphasis>&gt;
</literallayout>
<para>
The <emphasis role="bold">iarc</emphasis> command defines an invisible arc. Its options are the same as for
the <emphasis role="bold">arc</emphasis> command. Although the arc is not actually drawn, any text supplied
is output, and the invisible arc can form part of a shape that is filled. The
arc counts towards the bounding box only if there is text, or if it is part of
a filled shape.
</para>
</section>
<section>
<title>ibox</title>
<literallayout>
&lt;<emphasis>as box</emphasis>&gt;
</literallayout>
<para>
The <emphasis role="bold">ibox</emphasis> command defines an invisible box. Its options are the same as for
the <emphasis role="bold">box</emphasis> command. Although the box is not actually drawn, any text supplied
is output, and the shape is filled if <emphasis role="bold">filled</emphasis> is specified. The box counts
towards the bounding box only if there is text, or if it is filled.
</para>
</section>
<section>
<title>icircle</title>
<literallayout>
&lt;<emphasis>as circle</emphasis>&gt;
</literallayout>
<para>
The <emphasis role="bold">icircle</emphasis> command defines an invisible circle. Its options are the same
as for the <emphasis role="bold">circle</emphasis> command. Although the circle is not actually drawn, any
text supplied is output, and the shape is filled if <emphasis role="bold">filled</emphasis> is specified.
The circle counts towards the bounding box only if there is text, or if it is
filled.
</para>
</section>
<section>
<title>icurve</title>
<literallayout>
&lt;<emphasis>as curve</emphasis>&gt;
</literallayout>
<para>
The <emphasis role="bold">icurve</emphasis> command defines an invisible B&egrave;zier curve. Its options
are the same as for the <emphasis role="bold">curve</emphasis> command. Although the curve is not actually
drawn, any text supplied is output, and the invisible curve can form part of a
shape that is filled. The curve counts towards the bounding box only if there
is text, or if it is part of a filled shape.
</para>
</section>
<section>
<title>iellipse</title>
<literallayout>
&lt;<emphasis>as ellipse</emphasis>&gt;
</literallayout>
<para>
The <emphasis role="bold">iellipse</emphasis> command defines an invisible ellipse. Its options are the same
as for the <emphasis role="bold">ellipse</emphasis> command. Although the ellipse is not actually drawn, any
text supplied is output, and the shape is filled if <emphasis role="bold">filled</emphasis> is specified.
The ellipse counts towards the bounding box only if there is text, or if it is
filled.
</para>
</section>
<section>
<title>iline</title>
<literallayout>
&lt;<emphasis>as line</emphasis>&gt;
</literallayout>
<para>
The <emphasis role="bold">iline</emphasis> command defines an invisible line. Its options are the same as
for the <emphasis role="bold">line</emphasis> command. Although the line is not actually drawn, any text
supplied is output, and the invisible line can form part of a shape that is
filled. The line counts towards the bounding box only if there is text, or if
it is part of a filled shape.
</para>
</section>
<section id="SECTLINE">
<title>line</title>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="72" align="left"/>
<colspec colwidth="200" align="left"/>
<tbody>
<row>
<entry></entry>
<entry><emphasis role="bold">align</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">colour</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">dashed</emphasis></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">down</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;*</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">from</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>label</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">grey</emphasis></entry>
<entry>&lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">left</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;*</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">level</emphasis></entry>
<entry>&lt;<emphasis>integer</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">right</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;*</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">shapefilled</emphasis></entry>
<entry>&lt;<emphasis>colour</emphasis>&gt; &nbsp; | &nbsp; &lt;<emphasis>greylevel</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">thickness</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">to</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">up</emphasis></entry>
<entry>&lt;<emphasis>length</emphasis>&gt;*</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
This command draws a straight line. The start is given by the <emphasis role="bold">from</emphasis> option;
if it specifies a label only, the starting point on the referenced shape is its
end point if it is a straight line, arc, or curve. Otherwise the starting point
is determined by the direction of this line. For example, a line to the right
from a box starts at the midpoint of the right-hand edge. The <emphasis role="bold">to</emphasis> option can
be used to specify the end point by reference to the previous or some other
shape. For example:
</para>
<literallayout class="monospaced">
box; line from bottom right to 0.25 top;
</literallayout>
<para>
When the <emphasis role="bold">to</emphasis> option is not used, a horizontal and/or a vertical distance
(that is, Cartesian coordinates relative to the start) can be specified by the
options <emphasis>up</emphasis>, <emphasis>down</emphasis>, <emphasis>left</emphasis>, or <emphasis>right</emphasis>. If none of these are
present, the line is drawn in the current direction. In this case, and also if
a direction is given without a length, the current default horizontal or
vertical length (as appropriate) is used unless the <emphasis role="bold">align</emphasis> option applies
(see below). Here are some examples:
</para>
<literallayout class="monospaced">
line;
line right;
line up right;
line down 20 left;
line down 40 right 60;
</literallayout>
<para>
The <emphasis role="bold">align</emphasis> option can be used only with horizontal or vertical lines. The
vertical or horizontal coordinate of the &lt;<emphasis>position</emphasis>&gt; specified by <emphasis role="bold">align</emphasis>
is used, as appropriate, overriding any other value. For example:
</para>
<literallayout class="monospaced">
A: box "A";
L: line right;
B: box "B";
   line down from bottom of A;
   line right align middle of L;
   line up align right of A;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic38.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
As always, a reference to an unqualified box edge implies the midpoint of that
edge.
</para>
<para>
For a horizontal line, text is positioned at the midpoint of the line, centred
by default. If there is more than one string, they are positioned both above
and below the line. For non-horizontal lines, text is left-justified (by
default) close to the midpoint of the line.
</para>
</section>
<section>
<title>text</title>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="72" align="left"/>
<colspec colwidth="200" align="left"/>
<tbody>
<row>
<entry></entry>
<entry><emphasis role="bold">at</emphasis></entry>
<entry>&lt;<emphasis>position</emphasis>&gt;</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">level</emphasis></entry>
<entry>&lt;<emphasis>integer</emphasis>&gt;</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
This command does nothing unless it ends with at least one optional text
string. It provides a means of outputting text without drawing a graphic shape.
It may not be labelled, and whatever is set as the previous shape is unchanged.
The text is centre-justified by default, both horizontally and vertically. If
no <emphasis role="bold">at</emphasis> option is given, the text is positioned with reference to the
previous shape. For a closed shape it is put at the centre of the shape, for a
straight line at the midpoint of the line, for a circular arc at the centre of
the circle. and for a B&egrave;zier curve at the midpoint of the base line.
</para>
<para>
String options can be used to make fine adjustments to the position of the
text. For example, if text is placed to the right of a horizontal line, it
should normally be specified as left-justified.
</para>
<literallayout class="monospaced">
line; text at end "ABC";
iline right 20;
line; text at end "ABC"/l;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic39.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
In the first of these two examples, the default centre-justification has caused
the text to be output on top of the line. The <emphasis role="bold">text</emphasis> command is often the
easiest way of positioning strings that are not near the default string position
for a shape.
</para>
<literallayout class="monospaced">
box width 40 depth 40; text at top "N"; text at bottom "S";
text at left "W"; text at right "E";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic54.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
</section>
</chapter>

<chapter>
<title>Filled shapes</title>
<para>
Boxes, circles, and ellipses are filled when they have the <emphasis role="bold">filled</emphasis> option
set, or if the <emphasis role="bold">boxfill</emphasis>, <emphasis role="bold">circlefill</emphasis>, or <emphasis role="bold">ellipsefill</emphasis> commands have
been used to set filling as a default (see chapter <xref linkend="CHAPENV"/>). If the shape
is invisible, no outline is drawn, and only the filling is shown. Otherwise,
the outline is drawn in the line-drawing colour. For example:
</para>
<literallayout class="monospaced">
box grey 0.5 filled 0.8; iline right 10; ibox filled 0.8;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic40.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
A sequence of lines, arcs, and B&egrave;zier curves with the same
<emphasis role="bold">shapefilled</emphasis> values and the same general characteristics (line width,
colour, dash parameters, and level) is turned into a closed outline (if
necessary) and filled. The lines and arcs themselves are drawn as normal,
unless they are invisible. The automatically supplied line that closes such a
shape is not drawn. A dummy command such as:
</para>
<literallayout class="monospaced">
line left 0;
</literallayout>
<para>
is sometimes needed to separate two successive shapes that have the same
characteristics. You can set a <emphasis role="bold">shapefilled</emphasis> value as a default, to save
having to repeat it for all the different constituents of a shape. The ability
to save and restore the environment (see chapter <xref linkend="CHAPSAVERESTORE"/>) can be
helpful here:
</para>
<literallayout class="monospaced">
push; shapefill 0.9 0.5 0.1;
arc; arc; line left; line down 10;
line right; line right; line up 10;
pop;
</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic41.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Arrowheads on lines and arcs are filled if the <emphasis role="bold">filled</emphasis> option is set on the
appropriate drawing command. Alternatively, the <emphasis role="bold">arrowfill</emphasis> command can be
used to specify a default filling colour (see chapter <xref linkend="CHAPSAVERESTORE"/>).
</para>
<para>
The concept of &#x2018;levels&#x2019; is important when filled shapes are being drawn,
because filling a shape obliterates anything that is underneath it, even if the
filling colour is lighter than what was there before. It is like using opaque
paint. By specifying different levels for different components of a drawing,
you can control the order in which they are output, and therefore which parts
are obliterated by other parts. The default level is zero; items on higher
levels are output later (&#x2018;above&#x2019;), whereas items on lower levels are output
earlier (&#x2018;below&#x2019;). Items at the same level are output in the order in which
they are defined. Consider this example:
</para>
<literallayout class="monospaced">
box filled 0.5; box at centre plus (10,10) filled 0.5;
iline right 10;
box filled 0.5; box at centre plus (10,10) filled 0.5 level -1;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic42.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The second box is &#x2018;above&#x2019; the first box, but because of the <emphasis role="bold">level</emphasis>
specification, the fourth box is &#x2018;below&#x2019; the third box. A default level can be
set by means of the <emphasis role="bold">level</emphasis> command (see chapter <xref linkend="CHAPENV"/>).
</para>
</chapter>

<chapter>
<title>Altering the &#x2018;last&#x2019; item</title>
<para>
Occasionally it is useful to be able to change which shape is considered to be
the previous shape when the next shape is drawn. The <emphasis role="bold">goto</emphasis> command, which is
followed by a label, is used to do this. It can be useful in macros. Consider a
macro that draws a box with diagonals. When this macro is called, you may want
subsequent shapes to be positioned relative to the box, not to the diagonal
lines. This example shows how this can be done:
</para>
<literallayout class="monospaced">
macro diag {
A&amp;$: box;
line from top right to bottom left;
line from top left of A&amp;$ to bottom right of A&amp;$;
goto A&amp;$; };

diag; arrow; diag;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic43.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The final <emphasis role="bold">goto</emphasis> in the macro causes any subsequent shapes to be positioned
with reference to the box. Without the final <emphasis role="bold">goto</emphasis> in the macro, the &#x2018;last
item&#x2019; after a macro call would be the second diagonal line.
</para>
<para>
If <emphasis role="bold">goto</emphasis> is followed by an asterisk instead of a label, it unsets the last
item. Aspic then treats the next item as if it were the first. This feature is
mostly useful for testing.
</para>
</chapter>

<chapter id="CHAPDIRECTION">
<title>Changing the current direction</title>
<para>
The current direction defaults to &#x2018;right&#x2019;. It can be changed by the commands
<emphasis role="bold">up</emphasis>, <emphasis role="bold">down</emphasis>, <emphasis role="bold">left</emphasis>, and <emphasis role="bold">right</emphasis>, which have no arguments. The current
direction is used in the following circumstances:
</para>
<orderedlist numeration="arabic">
<listitem>
<para>
When drawing a line, if no direction is specified;
</para>
</listitem>
<listitem>
<para>
When drawing an arc, if no direction is specified and a start point is given
without an end point;
</para>
</listitem>
<listitem>
<para>
When drawing an arc after a closed shape, if neither a direction nor a start
point is given.
</para>
</listitem>
<listitem>
<para>
When one closed shape follows another, to determine their relative positions if
no <emphasis role="bold">join</emphasis> option is given;
</para>
</listitem>
</orderedlist>
<para>
Note that the current direction is <emphasis>not</emphasis> used when a closed shape follows a
line or arc; the position of the closed shape in this case is determined by the
direction of the end of the line or arc. For example,
</para>
<literallayout class="monospaced">
right; box "A"; arc "1"; box "B";
down; arc "2"; box "C";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic44.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The initial direction of the arcs in this example is determined by the current
direction, but the boxes that follow them are positioned with reference to the
ending direction of the arc. (This can be changed by using the <emphasis role="bold">join</emphasis> option
of the <emphasis role="bold">box</emphasis> command.)
</para>
</chapter>

<chapter id="CHAPFONT">
<title>Font control and character coding</title>
<para>
Text is output by default in a 12-point Times-Roman font, though certain
special characters in PostScript output may use other fonts, as described in
section <xref linkend="SECTPSOUT"/> below. Additional fonts can be specified by the
<emphasis role="bold">bindfont</emphasis> command, and individual strings can be output in any of the bound
fonts.
</para>
<section>
<title>The bindfont command</title>
<para>
The <emphasis role="bold">bindfont</emphasis> command is used to define additional fonts, at specified
sizes. The <emphasis role="bold">magnify</emphasis> command (see section<xref linkend="SECTMAGNIFY"/>) does not affect
the size of text. The syntax of <emphasis role="bold">bindfont</emphasis> is as follows:
</para>
<literallayout>
<literal>bindfont</literal>  &lt;<emphasis>number</emphasis>&gt;  &lt;<emphasis>fontname</emphasis>&gt;  &lt;<emphasis>font size</emphasis>&gt;
</literallayout>
<para>
For example:
</para>
<literallayout class="monospaced">
bindfont 1 "Times-Italic" 12;
bindfont 2 "Times-Bold" 16;
</literallayout>
<para>
The font number must be greater than zero (the default font has the number
zero). Once a font has been bound, it may be referenced in a <emphasis role="bold">setfont</emphasis>
command to make it the default font, or it may be specified for an individual
text string. For example:
</para>
<literallayout class="monospaced">
setfont 2; box "this is font 2" "this is font 1"/1;
</literallayout>
<para>
For PostScript output, the font name is used verbatim. For SVG output, if the
name contains a hyphen, it is split into two parts. The first part (or the
whole name if there is no hyphen) is output as the <emphasis role="bold">font-family</emphasis> parameter
for text strings. The second part is used to control the <emphasis role="bold">font-style</emphasis> and
<emphasis role="bold">font-weight</emphasis> parameters. Aspic recognizes the suffixes &#x2018;Italic&#x2019;, &#x2018;Bold&#x2019;, and
&#x2018;BoldItalic&#x2019;.
</para>
</section>
<section>
<title>The setfont command</title>
<para>
The <emphasis role="bold">setfont</emphasis> command changes the default font for subsequent text strings.
It must be followed by a non-negative font number.
</para>
</section>
<section>
<title>The textdepth and fontdepth commands</title>
<para>
When multiple text items are specified with a drawing command, they are output
one below the other. The default vertical separation is computed from the sizes
of the fonts. This can be increased (but not decreased) by the <emphasis role="bold">textdepth</emphasis>
command, which sets a minimum vertical separation for subsequent items.
</para>
<para>
Aspic also needs to know the approximate height of letters when positioning
text vertically, for example, when centring a single line of text within a box.
Since it does not itself do any text processing, it guesses a height from the
font size. This can be increased (but not decreased) by the <emphasis role="bold">fontdepth</emphasis>
command, though this should rarely be needed.
</para>
</section>
<section id="SECTCODES">
<title>Input character encoding</title>
<para>
Aspic assumes that text strings specify characters in Unicode. Using escapes,
it is possible to encode all possible characters using only ASCII input.
Characters may also be encoded as UTF-8 sequences or (for backwards
compatibilty) as single bytes. The input byte sequence is handled as follows:
</para>
<itemizedlist>
<listitem>
<para>
Bytes with values less than 128, with the exception of ampersand, are
interpreted as single-byte Unicode code points &ndash; these are of course identical
to ASCII. If the <emphasis role="bold">-tr</emphasis> command line option is given, the following
translations are then performed:
</para>
<itemizedlist>
<listitem>
<para>
A single grave accent character (<literal>`</literal>) is translated to an opening typographic
quote (&#x2018;) using code point U+2018.
</para>
</listitem>
<listitem>
<para>
Two grave accents in succession are translated to a double typographic opening
quote (&#x2018;&#x2018;) using code point U+201C.
</para>
</listitem>
<listitem>
<para>
A single quote character (<literal>'</literal>) is translated to a closing typographic quote
(&#x2019;), which is the same as an apostrophe, using code point U+2019.
</para>
</listitem>
<listitem>
<para>
Two single quotes in succession are translated to a double closing typographic
quote (&#x2019;&#x2019;) using code point is U+201C.
</para>
</listitem>
<listitem>
<para>
Two hyphens in succession are translated to an en-dash (&ndash;) using code point
U+2013.
</para>
</listitem>
</itemizedlist>
<para>
If any of the translated characters are required when the <emphasis role="bold">-tr</emphasis> option is on,
they can be specified using numerical escapes. It is only the literal
characters that are translated.
</para>
</listitem>
<listitem>
<para>
If an ampersand character is encountered, the following bytes are inspected:
</para>
<itemizedlist>
<listitem>
<para>
An ampersand followed by a sharp (hash) sign and a sequence of digits
terminated by a semicolon represents the code point defined by the decimal
number. For example, <literal>&amp;#169;</literal> specifies a copyright symbol.
</para>
</listitem>
<listitem>
<para>
An ampersand followed by a sharp (hash) sign, an x, and a sequence of
hexadecimal digits terminated by a semicolon represents the code point defined
by the hexadecimal number. For example, <literal>&amp;#xa9;</literal> is another way of
specifying a copyright symbol.
</para>
</listitem>
<listitem>
<para>
If an ampersand is followed by a letter and then a sequence of alphanumeric
characters terminated by a semicolon, it is treated as a named entity
reference. Aspic contains a table of named entities taken from the DocBook
documentation. For example, <literal>&amp;copy;</literal> is a third way of specifying a
copyright symbol.
</para>
</listitem>
<listitem>
<para>
If an ampersand is not followed by one of the above forms, or if an entity name
is not found in Aspic&#x2019;s inbuilt list, the ampersand character is treated as a
literal.
</para>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<para>
When a byte with a value of 128 or above is encountered, it and the following
bytes are inspected to see if they form a valid UTF-8 sequence. If they do, the
code point that it encodes is used. If they do not, the value of the single byte
is taken as the code point. This means that isolated high-value bytes in an
otherwise ASCII source are treated as ISO 8859 characters. Several such bytes
in succession might accidentally form a valid UTF-8 sequence, so Aspic cannot
be guaranteed to handle every possible ISO 8859 input document.
</para>
</listitem>
</itemizedlist>
</section>
<section id="SECTPSOUT">
<title>PostScript output character encoding</title>
<para>
PostScript output consists entirely of ASCII characters. In strings,
parentheses, backslashes, and code points greater than 127 are escaped using
the normal PostScript backslash escape mechanism.
</para>
<para>
When generating PostScript output, Aspic handles fonts that are defined with
PostScript&#x2019;s <emphasis>standard encoding</emphasis> as their default in a special way. A font
may contain more than 256 characters, though only 256 are accessible in any
font &#x2018;binding&#x2019;, via an encoding vector that translates character numbers to
names. The encoding can be changed when the font is bound.
</para>
<para>
The PostScript standard encoding is not the same as Unicode, and in any case,
Aspic needs to access more than 256 characters in these fonts. It does this by
binding two versions of a font, and re-encoding both of them. The first is
encoded with the first 256 Unicode code points. The second is encoded with
characters 0&ndash;127 corresponding to Unicode code points U+0100 to U+017F and
characters with codes greater than 127 corresponding to those Unicode
characters with code points greater than U+017F that are available in the font
(for example, typographic quotes). This use of two fonts is handled
automatically.
</para>
<para>
If a character is not available in a standardly encoded font, Aspic checks to
see if it can be found in the Symbol or Dingbats fonts. The former contains
Greek and mathematical characters, and the latter contains various special
symbols such as &check;. If a character is not available in any of these fonts,
it is output as the currency symbol &curren;.
</para>
<para>
The result of this special processing is that, for a font that is standardly
encoded by default, Unicode code points can be used for all the characters in
that font, as well as characters in the Symbol and Dingbats fonts. You do not
need to set up any separate special fonts.
</para>
<para>
If, on the other hand, you specify a font that does not use the
standard encoding by default, Aspic makes no changes to it. Character values in
the range 0&ndash;255 will correspond to its default encoding. The behaviour of
other character values is undefined.
</para>
</section>
<section>
<title>SVG output character encoding</title>
<para>
SVG output consists entirely of ASCII characters. In text strings, angle
brackets and ampersands are converted to the named XML entities <literal>&amp;gt;</literal>,
<literal>&amp;lt;</literal>, and <literal>&amp;amp;</literal>, respectively. Characters whose code points are
greater than 127 are output as hexadecimal numerical escapes. For example, the
copyright character is output as <literal>&amp;#xa9;</literal>.
</para>
</section>
</chapter>

<chapter>
<title>Overall Aspic configuration</title>
<para>
This chapter describes commands that affect the overall appearance of the
picture.
</para>
<section id="SECTBBOX">
<title>boundingbox</title>
<para>
This command causes Aspic to draw a frame round the picture. It must be
followed by a length, specifying the width of gap between the actual bounding
box of the picture, and the frame. For example,
</para>
<literallayout class="monospaced">
boundingbox 20;
</literallayout>
<para>
If a value of zero is given, the frame that is drawn is the actual bounding
box. Because Aspic does not process text items itself, it has to guess a
bounding box for them, and so under some circumstances the computed bounding
box for a picture may not be strictly accurate.
</para>
<para>
The gap width may optionally be followed by any of the following options of the
<emphasis role="bold">box</emphasis> command (see section <xref linkend="SECTBOX"/>): <emphasis role="bold">colour</emphasis>, <emphasis role="bold">dashed</emphasis>,
<emphasis role="bold">filled</emphasis>, <emphasis role="bold">grey</emphasis>, <emphasis role="bold">thickness</emphasis>. For example:
</para>
<literallayout class="monospaced">
boundingbox 5 dashed filled 0.8, 0.8, 0 thickness 1 colour 1,0,0;
circleradius 15; circle "A";
iline right 5; circle filled 1,1,1 "B";
</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic55.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
If <emphasis role="bold">dashed</emphasis> is specified, the dash parameters are taken from the <emphasis role="bold">boxdash</emphasis>
setting in the current environment at the time that <emphasis role="bold">boundingbox</emphasis> is obeyed.
If <emphasis role="bold">boundingbox</emphasis> appears more than once, the last set of parameters is used.
</para>
</section>
<section id="SECTMAGNIFY">
<title>magnify</title>
<para>
This command specifies overall magnification of the graphic items in a picture.
It must be followed by a single number. For example
</para>
<literallayout class="monospaced">
magnify 0.8;
magnify 1.5;
</literallayout>
<para>
Magnification applies to those shapes that follow this command. Subsequent
appearances of <emphasis role="bold">magnify</emphasis> apply cumulatively to the previous magnfication.
Magnification does <emphasis>not</emphasis> apply to text. If smaller or larger text is
required, suitable fonts must be set up and used.
</para>
</section>
<section>
<title>resolution</title>
<para>
This command sets the resolution of the output; it must be followed by a single
fixed-point number. All output dimensions are rounded to this resolution. The
default depends on the output style. For PostScript it is 0.12, which
corresponds to 600 dpi; for SVG output it is 0.001, which disables rounding.
If <emphasis role="bold">resolution</emphasis> appears more than once, the last value is used.
</para>
</section>
</chapter>

<chapter id="CHAPSAVERESTORE">
<title>Saving and restoring the environment</title>
<para>
The Aspic <emphasis>environment</emphasis> consists of a number of parameters that control the
way items are drawn. They are listed in the following table, together with
their initial values:
</para>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="160" align="left"/>
<colspec colwidth="160" align="left"/>
<tbody>
<row>
<entry></entry>
<entry>arc radius</entry>
<entry>36.0</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry>arrowhead filling</entry>
<entry>no filling</entry>
</row>
<row>
<entry></entry>
<entry>arrowhead length</entry>
<entry>10.0</entry>
</row>
<row>
<entry></entry>
<entry>arrowhead width</entry>
<entry>10.0</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry>box dash parameters</entry>
<entry>7.0&nbsp;&nbsp;5.0</entry>
</row>
<row>
<entry></entry>
<entry>box depth</entry>
<entry>36.0</entry>
</row>
<row>
<entry></entry>
<entry>box edge colour</entry>
<entry>0.0&nbsp;&nbsp;0.0&nbsp;&nbsp;0.0</entry>
</row>
<row>
<entry></entry>
<entry>box edge thickness</entry>
<entry>0.5</entry>
</row>
<row>
<entry></entry>
<entry>box filling</entry>
<entry>no filling</entry>
</row>
<row>
<entry></entry>
<entry>box width</entry>
<entry>72.0</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry>circle dash parameters</entry>
<entry>7.0&nbsp;&nbsp;5.0</entry>
</row>
<row>
<entry></entry>
<entry>circle edge colour</entry>
<entry>0.0&nbsp;&nbsp;0.0&nbsp;&nbsp;0.0</entry>
</row>
<row>
<entry></entry>
<entry>circle edge thickness</entry>
<entry>0.4</entry>
</row>
<row>
<entry></entry>
<entry>circle filling</entry>
<entry>no filling</entry>
</row>
<row>
<entry></entry>
<entry>circle radius</entry>
<entry>36.0</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry>current direction</entry>
<entry>right</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry>ellipse dash parameters</entry>
<entry>7.0&nbsp;&nbsp;5.0</entry>
</row>
<row>
<entry></entry>
<entry>ellipse depth</entry>
<entry>36.0</entry>
</row>
<row>
<entry></entry>
<entry>ellipse edge colour</entry>
<entry>0.0&nbsp;&nbsp;0.0&nbsp;&nbsp;0.0</entry>
</row>
<row>
<entry></entry>
<entry>ellipse edge thickness</entry>
<entry>0.4</entry>
</row>
<row>
<entry></entry>
<entry>ellipse filling</entry>
<entry>no filling</entry>
</row>
<row>
<entry></entry>
<entry>ellipse width</entry>
<entry>72.0</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry>level</entry>
<entry>0</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry>line dash parameters</entry>
<entry>7.0&nbsp;&nbsp;5.0</entry>
</row>
<row>
<entry></entry>
<entry>line colour</entry>
<entry>0.0&nbsp;&nbsp;0.0&nbsp;&nbsp;0.0</entry>
</row>
<row>
<entry></entry>
<entry>line horizontal length</entry>
<entry>72.0</entry>
</row>
<row>
<entry></entry>
<entry>line thickness</entry>
<entry>0.4</entry>
</row>
<row>
<entry></entry>
<entry>line vertical length</entry>
<entry>36.0</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry>magnification</entry>
<entry>1.0</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry>shape filling</entry>
<entry>no filling</entry>
</row>
<row>
<entry></entry>
<entry></entry>
<entry></entry>
</row>
<row>
<entry></entry>
<entry>text colour</entry>
<entry>0.0&nbsp;&nbsp;0.0&nbsp;&nbsp;0.0</entry>
</row>
<row>
<entry></entry>
<entry>text line depth</entry>
<entry>12.0</entry>
</row>
<row>
<entry></entry>
<entry>text font</entry>
<entry>0</entry>
</row>
<row>
<entry></entry>
<entry>text font depth</entry>
<entry>6.0</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
Many of these values can be overridden for a single item by the use of options
on the drawing command. There are also commands for dynamically changing these
values, so they become the defaults for commands that do not specify the
relevant options. The <emphasis role="bold">magnify</emphasis> command is described in section
<xref linkend="SECTMAGNIFY"/>, and commands to change the current direction are described
in chapter <xref linkend="CHAPDIRECTION"/>. Commands to change the remaining values are
described in the next chapter.
</para>
<para>
It is often useful to be able to save the current state of the environment and
restore it later. The <emphasis role="bold">push</emphasis> and <emphasis role="bold">pop</emphasis> commands are provided to do this.
The <emphasis role="bold">push</emphasis> command puts a copy of the current environment onto a stack, and
<emphasis role="bold">pop</emphasis> restores the environment from the top item on the stack.
</para>
</chapter>

<chapter id="CHAPENV">
<title>Changing environment parameters</title>
<para>
In addition to the commands for changing the current direction and the
<emphasis role="bold">magnify</emphasis> command, which are specified above in chapter <xref linkend="CHAPDIRECTION"/>
and section <xref linkend="SECTMAGNIFY"/>, respectively, the following commands are
provided for changing the values of environmental parameters. The changed value
applies to subsequently defined items, and a value may be changed as often as
necessary. The entire environment can be saved and restored by means of the
<emphasis role="bold">push</emphasis> and <emphasis role="bold">pop</emphasis> commands.
</para>
<para>
Most of these commands take a single numerical argument. The exceptions are
those that set dashed line parameters, and those that specify a colour. The
former take two arguments, specifying the length of dashes and the length of
gaps, respectively, and the latter take three arguments, specifying the red,
green, and blue components of the colour. Setting a grey value is equivalent to
setting a colour with three identical values.
</para>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="160" align="left"/>
<colspec colwidth="200" align="left"/>
<tbody>
<row>
<entry></entry>
<entry><literal>arcradius</literal></entry>
<entry>default radius for arcs</entry>
</row>
<row>
<entry></entry>
<entry><literal>arrowfill</literal></entry>
<entry>fill colour for arrowheads</entry>
</row>
<row>
<entry></entry>
<entry><literal>arrowlength</literal></entry>
<entry>length of arrowheads</entry>
</row>
<row>
<entry></entry>
<entry><literal>arrowwidth</literal></entry>
<entry>width of arrowheads</entry>
</row>
<row>
<entry></entry>
<entry><literal>boxcolour</literal></entry>
<entry>colour of box edges</entry>
</row>
<row>
<entry></entry>
<entry><literal>boxdash</literal></entry>
<entry>dash parameters for boxes</entry>
</row>
<row>
<entry></entry>
<entry><literal>boxdepth</literal></entry>
<entry>default depth of boxes</entry>
</row>
<row>
<entry></entry>
<entry><literal>boxfill</literal></entry>
<entry>colour of box interiors</entry>
</row>
<row>
<entry></entry>
<entry><literal>boxgrey</literal></entry>
<entry>greyness of box edges</entry>
</row>
<row>
<entry></entry>
<entry><literal>boxthickness</literal></entry>
<entry>thickness of box edges</entry>
</row>
<row>
<entry></entry>
<entry><literal>boxwidth</literal></entry>
<entry>default width of boxes</entry>
</row>
<row>
<entry></entry>
<entry><literal>circlecolour</literal></entry>
<entry>colour of circle edges</entry>
</row>
<row>
<entry></entry>
<entry><literal>circledash</literal></entry>
<entry>dash parameters for circles</entry>
</row>
<row>
<entry></entry>
<entry><literal>circlefill</literal></entry>
<entry>colour of circle interiors</entry>
</row>
<row>
<entry></entry>
<entry><literal>circlegrey</literal></entry>
<entry>greyness of circle edges</entry>
</row>
<row>
<entry></entry>
<entry><literal>circleradius</literal></entry>
<entry>default radius of circles</entry>
</row>
<row>
<entry></entry>
<entry><literal>circlethickness</literal></entry>
<entry>thickness of circle edges</entry>
</row>
<row>
<entry></entry>
<entry><literal>ellipsecolour</literal></entry>
<entry>colour of ellipse edges</entry>
</row>
<row>
<entry></entry>
<entry><literal>ellipsedash</literal></entry>
<entry>dash parameters for ellipses</entry>
</row>
<row>
<entry></entry>
<entry><literal>ellipsedepth</literal></entry>
<entry>default depth of ellipses</entry>
</row>
<row>
<entry></entry>
<entry><literal>ellipsefill</literal></entry>
<entry>colour of ellipse interiors</entry>
</row>
<row>
<entry></entry>
<entry><literal>ellipsegrey</literal></entry>
<entry>greyness of ellipse edges</entry>
</row>
<row>
<entry></entry>
<entry><literal>ellipsethickness</literal></entry>
<entry>thickness of ellipse edges</entry>
</row>
<row>
<entry></entry>
<entry><literal>ellipsewidth</literal></entry>
<entry>default width of ellipses</entry>
</row>
<row>
<entry></entry>
<entry><literal>fontdepth</literal></entry>
<entry>minimal character depth</entry>
</row>
<row>
<entry></entry>
<entry><literal>hlinelength</literal></entry>
<entry>default horizontal length for lines</entry>
</row>
<row>
<entry></entry>
<entry><literal>level</literal></entry>
<entry>default item level</entry>
</row>
<row>
<entry></entry>
<entry><literal>linecolour</literal></entry>
<entry>colour of lines</entry>
</row>
<row>
<entry></entry>
<entry><literal>linedash</literal></entry>
<entry>dash parameters for lines</entry>
</row>
<row>
<entry></entry>
<entry><literal>linegrey</literal></entry>
<entry>greyness of lines</entry>
</row>
<row>
<entry></entry>
<entry><literal>linethickness</literal></entry>
<entry>thickness of lines</entry>
</row>
<row>
<entry></entry>
<entry><literal>setfont</literal></entry>
<entry>the current font</entry>
</row>
<row>
<entry></entry>
<entry><literal>shapefill</literal></entry>
<entry>colour for shapes defined by lines/arcs</entry>
</row>
<row>
<entry></entry>
<entry><literal>textcolour</literal></entry>
<entry>colour for text</entry>
</row>
<row>
<entry></entry>
<entry><literal>textdepth</literal></entry>
<entry>minimal vertical text separation</entry>
</row>
<row>
<entry></entry>
<entry><literal>vlinelength</literal></entry>
<entry>default vertical length for lines</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<para>
Each kind of closed shape has its own set of parameters for controlling the
default thickness and colour of the lines used to draw it, and the appearance
of dashed lines. Setting the dash parameters does not of itself cause dashed
lines to be drawn; the <emphasis role="bold">dashed</emphasis> option must be given with the drawing
command. The default thickness, dashedness, and colour of arcs and curves is
the same as that for straight lines; hence there are no separate commands. For
example:
</para>
<literallayout class="monospaced">
linethickness 6; linegrey 0.5;
boxthickness 4; boxgrey 0.8;
arc left; line; box; line; arc up;

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic45.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Those commands that specify filling can be followed either by a single number,
to specify a shade of grey, or by three numbers for a general colour. To turn
off filling, a single negative number should be given. For example:
</para>
<literallayout class="monospaced">
circlefill 0.5; circle; circlefill 0.8 0.2 0.1; 
C: circle; line right 36; 
circlefill -1; circle join left to right of C; 

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic46.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
Note that turning off filling is not the same as filling with white. If the
third circle above is filled with white, it would hide the horizontal line.
The <emphasis role="bold">textdepth</emphasis> parameter controls the minimal vertical separation of
multiple text items. For example:
</para>
<literallayout class="monospaced">
box "one" "two"; textdepth 24; box "three" "four";

</literallayout>
<figure>
<mediaobject><imageobject>
<imagedata fileref="./pic47.eps"  scale="80" align="center"></imagedata></imageobject></mediaobject>
</figure>
<para>
&#x200b;
</para>
<para>
The <emphasis role="bold">fontdepth</emphasis> parameter can be set to the approximate height of letters in
a font. It is used when positioning text vertically, for example, when centring
a single line of text within a box. However, this parameter is used only when
it is greater than the depth computed from the size of the font.
</para>
</chapter>

<chapter>
<title>List of commands</title>
<para>
This is a complete list of all Aspic commands.
</para>
<informaltable frame="none">
<tgroup cols="3" colsep="0" rowsep="0">
<colspec colwidth="20" align="left"/>
<colspec colwidth="160" align="left"/>
<colspec colwidth="220" align="left"/>
<tbody>
<row>
<entry></entry>
<entry><emphasis role="bold">arc</emphasis></entry>
<entry>draw a circular arc</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">arcarrow</emphasis></entry>
<entry>draw a circular arc with arrowhead(s)</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">arcradius</emphasis></entry>
<entry>set default arc radius</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">arrow</emphasis></entry>
<entry>draw a straight line with arrowhead(s)</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">arrowfill</emphasis></entry>
<entry>set arrowhead fill colour</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">arrowlength</emphasis></entry>
<entry>set length of arrowheads</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">arrowwidth</emphasis></entry>
<entry>set width of arrowheads</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">bindfont</emphasis></entry>
<entry>bind a new font</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">boundingbox</emphasis></entry>
<entry>enclose picture in frame</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">box</emphasis></entry>
<entry>draw a box</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">boxcolour</emphasis></entry>
<entry>set default colour for boxes</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">boxdash</emphasis></entry>
<entry>set dash parameters for boxes</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">boxdepth</emphasis></entry>
<entry>set default depth for boxes</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">boxfill</emphasis></entry>
<entry>set box fill colour</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">boxgreyness</emphasis></entry>
<entry>set default greyness for boxes</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">boxthickness</emphasis></entry>
<entry>set default line thickness for boxes</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">boxwidth</emphasis></entry>
<entry>set default width for boxes</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">circle</emphasis></entry>
<entry>draw a circle</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">circlecolour</emphasis></entry>
<entry>set default colour for circles</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">circledash</emphasis></entry>
<entry>set dash parameters for circles</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">circlefill</emphasis></entry>
<entry>set circle fill colour</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">circlegrey</emphasis></entry>
<entry>set greyness for circles</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">circleradius</emphasis></entry>
<entry>set default radius for circles</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">circlethickness</emphasis></entry>
<entry>set thickness of lines for circles</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">curve</emphasis></entry>
<entry>draw a B&egrave;zier curve</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">down</emphasis></entry>
<entry>set current direction</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">ellipse</emphasis></entry>
<entry>draw an ellipse</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">ellipsecolour</emphasis></entry>
<entry>set default colour for ellipses</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">ellipsedash</emphasis></entry>
<entry>set dash parameters for ellipses</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">ellipsedepth</emphasis></entry>
<entry>set depth of ellipses</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">ellipsefill</emphasis></entry>
<entry>set ellipse fill colour</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">ellipsegrey</emphasis></entry>
<entry>set greyness for ellipses</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">ellipsethickness</emphasis></entry>
<entry>set line thickness for ellipses</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">ellipsewidth</emphasis></entry>
<entry>set width of ellipses</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">fontdepth</emphasis></entry>
<entry>set minimal height of letters</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">goto</emphasis></entry>
<entry>set named shape as previous</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">hlinelength</emphasis></entry>
<entry>set default horizontal line length</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">iarc</emphasis></entry>
<entry>draw an invisible arc</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">ibox</emphasis></entry>
<entry>draw an invisible box</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">icircle</emphasis></entry>
<entry>draw an invisible circle</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">icurve</emphasis></entry>
<entry>draw an invisible  B&egrave;zier curve</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">iellipse</emphasis></entry>
<entry>draw an invisible ellipse</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">iline</emphasis></entry>
<entry>draw an invisible line</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">include</emphasis></entry>
<entry>include a file&#x2019;s contents</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">left</emphasis></entry>
<entry>set current direction</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">level</emphasis></entry>
<entry>set default level</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">line</emphasis></entry>
<entry>draw a line</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">linecolour</emphasis></entry>
<entry>set colour for lines (and arcs and curves)</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">linedash</emphasis></entry>
<entry>set dash parameters for lines (and arcs and curves)</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">linegrey</emphasis></entry>
<entry>set greyness for lines (and arcs and curves)</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">linethickness</emphasis></entry>
<entry>set thickness of lines (and arcs and curves)</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">magnify</emphasis></entry>
<entry>magnify or reduce the picture</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">macro</emphasis></entry>
<entry>define an Aspic macro</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">pop</emphasis></entry>
<entry>restore environment from the stack</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">push</emphasis></entry>
<entry>push environment onto the stack</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">resolution</emphasis></entry>
<entry>set output resolution</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">right</emphasis></entry>
<entry>set current direction</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">set</emphasis></entry>
<entry>set value of variable</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">setfont</emphasis></entry>
<entry>set current font</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">shapefill</emphasis></entry>
<entry>set drawn shape fill colour</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">text</emphasis></entry>
<entry>output text at given position</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">textcolour</emphasis></entry>
<entry>set text colour</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">textdepth</emphasis></entry>
<entry>set minimal separation of text items</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">up</emphasis></entry>
<entry>set current direction</entry>
</row>
<row>
<entry></entry>
<entry><emphasis role="bold">vlinelength</emphasis></entry>
<entry>set default vertical line length</entry>
</row>
</tbody>
</tgroup>
</informaltable>
</chapter>

</book>
